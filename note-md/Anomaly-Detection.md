---
title: Anomaly Detection
date: 2020-11-04
tags: 
	- note
	- ML
	- Next-Step-of-ML
categories:
  - æŽå®æ¯…æœºå™¨å­¦ä¹ ç¬”è®°
---

# Anomaly Detection

ç¿»è¯‘æˆä¸­æ–‡å°±æ˜¯ï¼Œå¼‚å¸¸æŽ¢æµ‹ã€‚å¼‚å¸¸æŽ¢æµ‹å°±æ˜¯è¦è®©æœºå™¨çŸ¥é“"I don't know"ï¼Œè¿™ä»¶äº‹ã€‚



## Problem Formulation

å¼‚å¸¸æŽ¢æµ‹é—®é¢˜é€šå¸¸å½¢å¼åŒ–æˆä¸‹è¿°è¡¨ç¤ºå½¢å¼ï¼š

- ç»™å‡ºä¸€ä¸ªè®­ç»ƒæ•°æ®é›† $\{x^1, x^2,..., x^N\}$ 
- æˆ‘ä»¬æƒ³æ‰¾å‡ºä¸€ä¸ªå‡½æ•°åŽ»æŽ¢æµ‹è¾“å…¥ $x$ æ˜¯å¦å’Œè®­ç»ƒæ•°æ®ç›¸ä¼¼

ä¹Ÿå°±æ˜¯è¯´å¼‚å¸¸æŽ¢æµ‹çš„ä»»åŠ¡å°±æ˜¯æ‰¾ä¸€ä¸ªfunctionï¼Œè¿™ä¸ªfunctionåšçš„äº‹æƒ…å°±æ˜¯ï¼Œæˆ‘ä»¬ç»™å®ƒä¸€ä¸ªå’Œè®­ç»ƒæ•°æ®ç›¸ä¼¼çš„è¾“å…¥ï¼Œå®ƒå°±è¿”å›žä¸€ä¸ªç»“æžœå‘Šè¯‰æˆ‘ä»¬è¾“å…¥æ˜¯æ­£å¸¸çš„ï¼Œåä¹‹ï¼Œå½“æˆ‘ä»¬è¾“å…¥ä¸€ä¸ªå’Œè®­ç»ƒæ•°æ®å·®åˆ«éžå¸¸å¤§çš„æ ·æœ¬ï¼Œå®ƒå°±è¿”å›žä¸€ä¸ªç»“æžœå‘Šè¯‰æˆ‘ä»¬è¾“å…¥æ˜¯å¼‚å¸¸çš„ã€‚

![image-20201104165121762](images/image-20201104165121762.png)

é€šå¸¸æˆ‘ä»¬çœ‹åˆ°anomaly è¿™ä¸ªè¯éƒ½æ˜¯è´Ÿé¢çš„ï¼Œä½†æ˜¯è¿™é‡Œè¯´çš„å¼‚å¸¸æŽ¢æµ‹å¹¶ä¸æ˜¯è´Ÿé¢æ„æ€ï¼Œåªæ˜¯åœ¨è¯´æŸä¸ªæ•°æ®å’Œè®­ç»ƒæ•°æ®é›†ä¸­çš„æ•°æ®å·®åˆ«å¾ˆå¤§è€Œå·²ã€‚Anomaly æœ‰æ—¶ä¹Ÿä¼šç”¨outlier, novelty, exceptions æ›¿æ¢ï¼Œä½¿ç”¨noveltyçš„æ—¶å€™å°±æ˜¯æ‰¾ä¸€ä¸ªæ–°é¢–çš„ä¸œè¥¿ï¼Œæ‰€ä»¥ï¼Œæ€»çš„æ¥è¯´æˆ‘ä»¬å°±æ˜¯è¦æ‰¾å‡ºå’Œè®­ç»ƒé›†æ ·æœ¬ä¸ä¸€æ ·çš„ä¸œè¥¿ã€‚

è‡³äºŽæ€Žä¹ˆå®šä¹‰similarityï¼Œè¿™å°±æ˜¯Anomaly Detectionéœ€è¦æŽ¢è®¨çš„é—®é¢˜ï¼Œä¸åŒçš„æ–¹æ³•æˆ‘ä»¬è¦ç”¨ä¸åŒçš„æ–¹å¼å®šä¹‰ç›¸ä¼¼æ€§ã€‚



## What is Anomaly? 

è¿™é‡Œæˆ‘è¦å¼ºè°ƒä¸€ä¸‹ä»€ä¹ˆå«åšå¼‚å¸¸ï¼Œæœºå™¨åˆ°åº•è¦çœ‹åˆ°ä»€ä¹ˆæ‰åº”è¯¥è®¤å®šä¸ºAnomalyï¼Œè¿™å…¶å®žæ˜¯å–å†³ä½ æä¾›ç»™æœºå™¨ä»€ä¹ˆæ ·çš„è®­ç»ƒæ•°æ®ã€‚ä¸¾ä¸ªæ —å­ï¼š

![image-20201104194053884](images/image-20201104194053884.png)

å¦‚æžœä½ æä¾›äº†å¾ˆå¤šçš„é›·ä¸˜ä½œä¸ºè®­ç»ƒæ•°æ®ï¼Œçš®å¡ä¸˜å°±æ˜¯å¼‚å¸¸çš„ã€‚å¦‚æžœä½ æä¾›äº†å¾ˆå¤šçš„çš®å¡ä¸˜ä½œä¸ºè®­ç»ƒæ•°æ®ï¼Œé›·ä¸˜å°±æ˜¯å¼‚å¸¸çš„ã€‚å¦‚æžœä½ æä¾›å¾ˆå¤šçš„å®å¯æ¢¦ä½œä¸ºè®­ç»ƒæ•°æ®ï¼Œæ•°ç å®è´å°±æ˜¯å¼‚å¸¸çš„ã€‚



## Applications

å¼‚å¸¸æŽ¢æµ‹æœ‰å¾ˆå¤šåº”ç”¨ï¼Œæ¯”å¦‚å¯ä»¥åº”ç”¨åˆ°æ¬ºè¯ˆæ£€æµ‹ï¼ˆFraud Detectionï¼‰

### Fraud Detection

Fraud Detection åº”ç”¨äºŽé“¶è¡Œæˆ–ä¿é™©ç­‰è¡Œä¸šï¼ŒFraud åŒ…æ‹¬ä½†ä¸é™äºŽä¼ªé€ æ”¯ç¥¨ï¼Œä¿¡ç”¨å¡æ¬ºè¯ˆç­‰è¡Œä¸ºã€‚æ¬ºè¯ˆæŽ¢æµ‹çš„ç›®çš„æ˜¯é¢„æµ‹æ¬ºè¯ˆè¡Œä¸ºï¼Œé˜²æ­¢æ¬ºè¯ˆäº¤æ˜“çš„å‘ç”Ÿã€‚

è¿™ç§ä»»åŠ¡çš„è®­ç»ƒèµ„æ–™å°±æ˜¯æ­£å¸¸çš„åˆ·å¡æœºè¡Œä¸ºï¼Œæ”¶é›†å¾ˆå¤šçš„äº¤æ˜“è®°å½•ï¼Œè¿™äº›äº¤æ˜“è®°å½•æ˜¯ä¸ºæ­£å¸¸çš„äº¤æ˜“è¡Œä¸ºï¼ŒçŽ°åœ¨æ–°æ¥ä¸€ç¬”äº¤æ˜“è®°å½•ï¼Œæˆ‘ä»¬å°±æŠŠå®ƒè¾“å…¥åˆ°æ¨¡åž‹ä¸­ï¼Œåˆ¤æ–­è¿™ç¬”äº¤æ˜“æ˜¯å¦æœ‰å¼‚å¸¸ï¼Œç”šè‡³å¯ä»¥åšåˆ°é¢„æµ‹å’Œè¿™ç¬”äº¤æ˜“æœ‰å…³çš„å¯¹è±¡æŽ¥ä¸‹æ¥æ˜¯å¦æœ‰å‘ç”Ÿæ¬ºè¯ˆäº¤æ˜“çš„å¯èƒ½ï¼Œä»Žè€Œé¢„é˜²æ¬ºè¯ˆçš„å‘ç”Ÿã€‚ï¼ˆç›´è§‰ä¸Šå¯ä»¥ç®€å•çš„æƒ³è±¡ï¼šå¦‚æžœæ­£å¸¸çš„äº¤æ˜“é‡‘é¢æ¯”è¾ƒå°ï¼Œé¢‘çŽ‡æ¯”è¾ƒä½Žï¼Œè‹¥çŸ­æ—¶é—´å†…æœ‰éžå¸¸å¤šçš„é«˜é¢æ¶ˆè´¹ï¼Œè¿™å¯èƒ½æ˜¯å¼‚å¸¸è¡Œä¸ºï¼‰

è¿™ç§åº”ç”¨æ˜¯æœ‰ä¸€äº›æ¯”èµ›çš„ï¼Œä¸‹é¢æ˜¯kaggleä¸Šçš„é“¾æŽ¥ï¼š

>Ref: https://www.kaggle.com/ntnu-testimon/paysim1/home
>
>Ref: https://www.kaggle.com/mlg-ulb/creditcardfraud/home
>
>[å®žè·µç¯‡ï¼šä¸€ä¸ªå…³äºŽFraud Detectionçš„ä¾‹å­ï¼ˆä¸€ï¼‰](https://zhuanlan.zhihu.com/p/42267652)



### Network Intrusion Detection

å¼‚å¸¸æ£€æµ‹è¿˜å¯ä»¥åº”ç”¨åˆ°ç½‘ç»œç³»ç»Ÿçš„å…¥ä¾µæ£€æµ‹ï¼Œè®­ç»ƒæ•°æ®æ˜¯æ­£å¸¸çš„ç½‘ç»œè¿žæŽ¥ã€‚çŽ°åœ¨æ¥äº†ä¸€ä¸ªæ–°çš„è¿žæŽ¥ï¼Œä½ å¸Œæœ›ç”¨Anomaly Detection è®©æœºå™¨è‡ªåŠ¨å†³å®šè¿™ä¸ªæ–°çš„è¿žæŽ¥æ˜¯å¦ä¸ºæ”»å‡»è¡Œä¸ºã€‚

> Ref: http://kdd.ics.uci.edu/databases/kddcup99/kddcup99.html
>
> KDD99è€ç»å…¸äº†ðŸ˜‚



### Cancer Detection

å¼‚å¸¸æ£€æµ‹è¿˜å¯ä»¥åº”ç”¨åˆ°åŒ»ç–—ï¼ˆç™Œç»†èƒžçš„ä¾¦æµ‹ï¼‰ï¼Œè®­ç»ƒæ•°æ®æ˜¯æ­£å¸¸ç»†èƒžã€‚çŽ°åœ¨ç»™å‡ºä¸€ä¸ªæ–°çš„ç»†èƒžï¼Œè®©æœºå™¨åˆ¤æ–­è¿™ä¸ªç»†èƒžæ˜¯å¦ä¸ºç™Œç»†èƒžã€‚

> Ref: https://www.kaggle.com/uciml/breast-cancer-wisconsin-data/home



## Binary Classification

æŽ¥ä¸‹æ¥å°±æ˜¯å…·ä½“æ€Žä¹ˆä½œAnomaly Detection äº†ï¼Œç›´è§‰çš„æƒ³æ³•å°±æ˜¯ï¼šçŽ°åœ¨æˆ‘ä»¬å¯ä»¥æ”¶é›†æ­£è´Ÿä¸¤ç§è®­ç»ƒæ•°æ®ï¼š

- æ­£å¸¸æ•°æ®ï¼š$\{x^1,x^2,â‹¯,x^N\}$ 

- å¼‚å¸¸æ•°æ®ï¼š$\{\widetilde{x}^1, \widetilde{x}^2, â‹¯, \widetilde{x}^N\}$ 

ç„¶åŽtrainä¸€ä¸ªäºŒåˆ†ç±»å™¨å°±å®Œäº‹äº†ã€‚

è¿™ä¸ªé—®é¢˜å…¶å®žå¹¶æ²¡æœ‰é‚£ä¹ˆç®€å•ï¼Œå› ä¸ºä¸å¤ªå®¹æ˜“æŠŠå¼‚å¸¸æ£€æµ‹çœ‹ä½œä¸€ä¸ªbinary classificationçš„é—®é¢˜ã€‚ä¸ºä»€ä¹ˆè¿™æ ·è¯´å‘¢ï¼Ÿ

ä¸¾ä¸ªæ —å­ï¼Œæˆ‘ä»¬çŽ°åœ¨å°†PokÃ©mon è§†ä¸ºæ­£å¸¸æ•°æ®ï¼Œå°†å…¶ä»–æ‰€æœ‰äº‹ç‰©è§†ä¸ºå¼‚å¸¸æ•°æ®ï¼Œæˆ‘ä»¬è¦è®©æœºå™¨åˆ¤æ–­è¾“å…¥æ˜¯ä¸æ˜¯ä¸€ä¸ªPokÃ©mon ï¼š

![image-20201104202123555](images/image-20201104202123555.png)

é‚£é—®é¢˜æ¥äº†ï¼Œé¦–å…ˆä¸æ˜¯PokÃ©mon çš„äº‹ç‰©å¤ªå¤šäº†ï¼Œæ•°ç å®è´ä¸æ˜¯ï¼Œå‡‰å®«æ˜¥æ—¥ä¸æ˜¯ï¼Œæ°´å£¶ä¸æ˜¯ï¼Œæ‰€ä»¥æˆ‘ä»¬å¾ˆéš¾å°†é™¤æ­£å¸¸æ•°æ®ä»¥å¤–çš„æ‰€ä»¥äº‹ç‰©éƒ½å½’ç»“ä¸ºä¸€ç±»ï¼Œå¾ˆéš¾æ”¶é›†æ‰€æœ‰çš„å¼‚å¸¸æ•°æ®ï¼Œå¾ˆéš¾å°†å¼‚å¸¸æ•°æ®çš„ç‰¹å¾éƒ½è®©æœºå™¨è®°ä½ã€‚

å†è€…ï¼Œå¾ˆå¤šæ—¶å€™ä½ å¾ˆéš¾æ”¶é›†åˆ°å¼‚å¸¸æ•°æ®ï¼Œæ¯”å¦‚æ¬ºè¯ˆæ£€æµ‹ï¼Œåœ¨æ‰€æœ‰çš„äº¤æ˜“ä¸­ï¼Œå¼‚å¸¸äº¤æ˜“çš„æ¯”ä¾‹éžå¸¸è‡³å°‘ã€‚



## Categories

çŽ°åœ¨æˆ‘ä»¬æŠŠå¼‚å¸¸æ£€æµ‹ä»»åŠ¡åˆ†ä¸ºä¸¤ç±»ï¼š

![image-20201104203416673](images/image-20201104203416673.png)

ä¸€ç±»ï¼Œæ˜¯ä¸åªæœ‰è®­ç»ƒæ•°æ® $\{x^1,x^2,â‹¯,x^N\}$ ï¼ŒåŒæ—¶è¿™äº›æ•°æ®è¿˜å…·æœ‰label $\{\hat{y}^1,\hat{y}^2,â‹¯,\hat{y}^N\}$ ã€‚ ç”¨è¿™æ ·çš„æ•°æ®é›†å¯ä»¥trainå‡ºä¸€ä¸ªclassifierï¼Œè®©æœºå™¨é€šè¿‡å­¦ä¹ è¿™äº›æ ·æœ¬ï¼Œä»¥é¢„æµ‹å‡ºæ–°æ¥çš„æ ·æœ¬çš„labelï¼Œä½†æ˜¯æˆ‘ä»¬å¸Œæœ›åˆ†ç±»å™¨æœ‰èƒ½åŠ›çŸ¥é“æ–°ç»™æ ·æœ¬ä¸å±žäºŽåŽŸæœ¬çš„è®­ç»ƒæ•°æ®çš„ä»»ä½•ç±»åˆ«ï¼Œå®ƒä¼šç»™æ–°æ ·æœ¬è´´ä¸Šâ€œunknownâ€çš„æ ‡ç­¾ã€‚è®­ç»ƒclassifier å¯ä»¥ç”¨generative modelã€logistic regressionã€deep learningç­‰æ–¹æ³•ï¼Œä½ å¯ä»¥ä»Žä¸­æŒ‘ä¸€ä¸ªè‡ªå·±å–œæ¬¢çš„ç®—æ³•train å‡ºä¸€ä¸ªclassifier ã€‚

ä¸Šè¿°çš„è¿™ç§ç±»åž‹çš„ä»»åŠ¡ï¼Œtrainå‡ºçš„classifier å…·æœ‰çœ‹åˆ°ä¸çŸ¥é“çš„æ•°æ®ä¼šæ ‡ä¸Šè¿™æ˜¯æœªçŸ¥ç‰©çš„èƒ½åŠ›ï¼Œè¿™ç®—æ˜¯å¼‚å¸¸æ£€æµ‹çš„å…¶ä¸­ä¸€ç§ï¼Œåˆå«åšOpen-set Recognitionã€‚æˆ‘ä»¬å¸Œæœ›åšåˆ†ç±»çš„æ—¶å€™æ¨¡åž‹æ˜¯open çš„ï¼Œå®ƒå¯ä»¥è¾¨è¯†å®ƒæ²¡çœ‹è¿‡çš„ä¸œè¥¿ï¼Œæ²¡çœ‹è¿‡çš„ä¸œè¥¿å®ƒå°±è´´ä¸€ä¸ªâ€œunknownâ€çš„æ ‡ç­¾ã€‚

å¦ä¸€ç±»ï¼Œæ‰€æœ‰è®­ç»ƒæ•°æ®éƒ½æ˜¯æ²¡æœ‰label çš„ï¼Œè¿™æ—¶ä½ åªèƒ½æ ¹æ®çŽ°æœ‰èµ„æ–™çš„ç‰¹å¾åŽ»åˆ¤æ–­ï¼Œæ–°ç»™çš„æ ·æœ¬è·ŸåŽŸå…ˆçš„æ ·æœ¬é›†æ˜¯å¦ç›¸åƒã€‚è¿™ç§ç±»åž‹çš„æ•°æ®åˆåˆ†æˆä¸¤ç§æƒ…å†µï¼š

- Cleanï¼šæ‰‹ä¸Šçš„æ ·æœ¬æ˜¯å¹²å‡€çš„ï¼ˆæ‰€æœ‰çš„è®­ç»ƒæ ·æœ¬éƒ½æ˜¯æ­£å¸¸çš„æ ·æœ¬ï¼‰
- Pollutedï¼šæ‰‹ä¸Šçš„æ ·æœ¬å·²ç»è¢«æ±¡æŸ“ï¼ˆè®­ç»ƒæ ·æœ¬å·²ç»è¢«æ··æ‚äº†ä¸€äº›å¼‚å¸¸çš„æ ·æœ¬ï¼Œæ›´å¸¸è§ï¼‰

æƒ…å†µäºŒæ˜¯æ›´å¸¸è§çš„ï¼Œå¯¹äºŽåˆšæ‰çš„è¯ˆæ¬ºæ£€æµ‹çš„ä¾‹å­è€Œè¨€ï¼Œé“¶è¡Œæ”¶é›†äº†å¤§é‡çš„äº¤æ˜“è®°å½•ï¼Œå®ƒæŠŠæ‰€æœ‰çš„äº¤æ˜“è®°å½•éƒ½å½“åšæ˜¯æ­£å¸¸çš„ï¼Œç„¶åŽå‘Šè¯‰æœºå™¨è¿™æ˜¯æ­£å¸¸äº¤æ˜“è®°å½•ï¼Œç„¶åŽå¸Œæœ›æœºå™¨å¯ä»¥å€Ÿæ­¤æ£€æµ‹å‡ºå¼‚å¸¸çš„äº¤æ˜“ã€‚ä½†æ‰€è°“çš„æ­£å¸¸çš„äº¤æ˜“è®°å½•å¯èƒ½æ··æ‚äº†å¼‚å¸¸çš„äº¤æ˜“ï¼Œåªæ˜¯é“¶è¡Œåœ¨æ”¶é›†èµ„æ–™çš„æ—¶å€™ä¸çŸ¥é“è¿™ä»¶äº‹ã€‚æ‰€ä»¥æˆ‘ä»¬æ›´å¤šé‡åˆ°çš„æ˜¯ï¼šæ‰‹ä¸Šæœ‰è®­ç»ƒæ ·æœ¬ï¼Œä½†æˆ‘æ²¡æœ‰åŠžæ³•ä¿è¯æ‰€æœ‰çš„è®­ç»ƒæ ·æœ¬éƒ½æ˜¯æ­£å¸¸çš„ï¼Œå¯èƒ½æœ‰éžå¸¸å°‘é‡çš„è®­ç»ƒæ ·æœ¬æ˜¯å¼‚å¸¸çš„ã€‚



## Case 1: With Classifier

æˆ‘ä»¬æ¥çœ‹çœ‹æƒ…å†µä¸€ï¼Œå°±æ˜¯è®­ç»ƒæ ·æœ¬æœ‰labelçš„æƒ…å†µï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥trainå‡ºä¸€ä¸ªåˆå§‹çš„modelã€‚ä¸¾çš„æ —å­æ˜¯æ£€æµ‹è¾“å…¥æ˜¯ä¸æ˜¯è¾›æ™®æ£®å®¶æ—çš„äººç‰©ã€‚

![image-20201105183423740](images/image-20201105183423740.png)

![image-20201105183800249](images/image-20201105183800249.png)

æˆ‘ä»¬çŽ°åœ¨æ”¶é›†çš„è¾›æ™®æ£®å®¶åº­çš„äººç‰©éƒ½å…·æœ‰æ ‡æ³¨ï¼ˆéœ¸å­ï¼Œä¸½èŽŽï¼Œè·é©¬ï¼Œç¾Žæžï¼‰ï¼Œæœ‰äº†è¿™äº›è®­ç»ƒèµ„æ–™ä»¥åŽå°±å¯ä»¥è®­ç»ƒå‡ºä¸€ä¸ªè¾›æ™®æ£®å®¶åº­æˆå‘˜çš„åˆ†ç±»å™¨ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬å°±å¯ä»¥ç»™åˆ†ç±»å™¨çœ‹ä¸€å¼ ç…§ç‰‡ï¼Œå®ƒå°±å¯ä»¥åˆ¤æ–­è¿™ä¸ªç…§ç‰‡ä¸­çš„äººç‰©æ˜¯è¾›æ™®æ£®å®¶åº­é‡Œé¢çš„å“ªä¸ªäººç‰©ã€‚

![image-20201105183729406](images/image-20201105183729406.png)

è¿™ä¸ªæ•°æ®é›†æ¥è‡ªkaggleä¸Šä¸€ä¸ªéžå¸¸å–œæ¬¢è¾›æ™®æ£®å®¶åº­çš„äººï¼Œå®ƒcollectå¹¶ä¸”labeläº†æ•°åƒå¼ æ•°æ®ï¼Œä»¥ä¸‹æ˜¯å‚è€ƒé“¾æŽ¥

>Source of model: https://www.kaggle.com/alexattia/the-simpsons-characters-dataset/

ç„¶åŽï¼Œè¿™ä¸ªäººè®­ç»ƒå‡ºä¸€ä¸ªåˆ†ç±»å™¨ï¼Œç„¶åŽç”¨è¿™ä¸ªåˆ†ç±»å™¨åšäº†æµ‹è¯•ï¼Œç»“æžœæœ‰ç™¾åˆ†ä¹‹ä¹åå…­çš„æ­£ç¡®çŽ‡ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![image-20201105184121865](images/image-20201105184121865.png)

çŽ°åœ¨æˆ‘ä»¬æƒ³åšçš„äº‹æƒ…æ˜¯åŸºäºŽè¿™ä¸ªåˆ†ç±»å™¨æ¥è¿›è¡Œå¼‚å¸¸æ£€æµ‹ï¼Œåˆ¤æ–­è¾“å…¥çš„äººç‰©æ˜¯å¦æ¥è‡ªè¾›æ™®æ£®å®¶åº­ã€‚



### Confidence score

æˆ‘ä»¬åŽŸæœ¬æ˜¯ä½¿ç”¨åˆ†ç±»å™¨æ¥è¿›è¡Œåˆ†ç±»ï¼ŒçŽ°åœ¨å¸Œæœ›åˆ†ç±»å™¨ä¸ä»…å¯ä»¥æ¥è‡ªåˆ†ç±»ï¼Œè¿˜ä¼šè¾“å‡ºä¸€ä¸ªæ•°å€¼ï¼Œè¿™ä¸ªæ•°å€¼ä»£è¡¨ä¿¡å¿ƒåˆ†æ•°ï¼ˆConfidence score ï¼‰ï¼Œç„¶åŽæ ¹æ®è¿™ä¸ªä¿¡å¿ƒåˆ†æ•°åšå¼‚å¸¸æ£€æµ‹ã€‚

![image-20201105184444454](images/image-20201105184444454.png)

å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€ä¸ªé˜ˆå€¼ $\lambda$ ï¼Œè‹¥ä¿¡å¿ƒåˆ†æ•°å¤§äºŽ $\lambda$ å°±è¯´æ˜Žæ˜¯æ¥è‡ªäºŽè¾›æ™®æ£®å®¶åº­ã€‚è‹¥ä¿¡å¿ƒåˆ†æ•°å°äºŽ $\lambda$ å°±è¯´æ˜Žä¸æ˜¯æ¥è‡ªäºŽè¾›æ™®æ£®å®¶åº­.

é‚£é—®é¢˜å°±æ¥äº†ï¼Œå¦‚ä½•è®¡ç®—è¿™ä¸ªconfidence scoreå‘¢ï¼Ÿæˆ‘ä»¬å¸Œæœ›è¿™ä¸ªä¿¡å¿ƒåˆ†æ•°åº”è¯¥æœ‰è¿™æ ·çš„èƒ½åŠ›ï¼Œå½“æˆ‘ä»¬å°†å›¾ç‰‡è¾“å…¥è¾›æ™®æ£®å®¶åº­çš„åˆ†ç±»å™¨ä¸­ï¼Œè‹¥åˆ†ç±»å™¨éžå¸¸çš„è‚¯å®šè¿™ä¸ªå›¾ç‰‡åˆ°åº•æ˜¯è°ï¼Œè¾“å‡ºçš„ä¿¡å¿ƒåˆ†æ•°å°±ä¼šéžå¸¸çš„é«˜ï¼Œåä¹‹åˆ™ä½Žã€‚

éœ€è¦å†æä¸€å˜´çš„æ˜¯ï¼Œå½“æˆ‘ä»¬å°†å›¾ç‰‡è¾“å…¥åˆ†ç±»å™¨æ—¶ï¼Œåˆ†ç±»å™¨çš„è¾“å‡ºæ˜¯ä¸€ä¸ªå‡ çŽ‡åˆ†å¸ƒï¼ˆdistributionï¼‰ï¼Œæ˜¯è¿™å¼ å›¾ç‰‡å±žäºŽå„ä¸ªç±»åˆ«çš„å¯èƒ½æ€§çš„å¾—åˆ†ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![image-20201105185121024](images/image-20201105185121024.png)

ä»Žä¸Šå›¾ç›´è§‚çš„è§‚å¯Ÿæ¥çœ‹ï¼Œå½“åˆ†ç±»å™¨éžå¸¸ç¡®å®šä¸€ä¸ªè¾“å…¥çš„ç±»åˆ«çš„æ—¶å€™ï¼Œå®ƒä¼šç»™å‡ºå¾ˆé›†ä¸­çš„å¾—åˆ†ï¼Œåä¹‹åˆ™æ˜¯åˆ†æ•£çš„ã€‚

åˆšæ‰è®²çš„éƒ½æ˜¯å®šæ€§çš„åˆ†æžï¼ŒçŽ°åœ¨éœ€è¦å°†å®šæ€§åˆ†æžçš„ç»“æžœåŒ–ä¸ºä¿¡å¿ƒåˆ†æ•°ã€‚ä¸€ä¸ªéžå¸¸ç›´è§‰çš„æ–¹æ³•å°±æ˜¯å°†åˆ†ç±»å™¨è¾“å‡ºçš„åˆ†å¸ƒä¸­æœ€é«˜æ•°å€¼ä½œä¸ºä¿¡å¿ƒåˆ†æ•°ï¼Œæ‰€ä»¥ä¸Šé¢é‚£å¼ å›¾è¾“å‡ºçš„ä¿¡å¿ƒåˆ†æ•°ä¸º0.97ï¼ˆéœ¸å­ï¼‰ï¼Œä¸‹é¢é‚£å¼ å›¾è¾“å‡ºçš„ä¿¡å¿ƒåˆ†æ•°ä¸º0.26ï¼ˆå‡‰å®«æ˜¥æ—¥ï¼‰ã€‚ï¼ˆè¿™ä¸ªæ–¹æ³•å°±æ˜¯åŽé¢æˆ‘ä»¬åšå®žéªŒç”¨çš„æ–¹æ³•ï¼‰å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![image-20201105185512635](images/image-20201105185512635.png)

æ ¹æ®ä¿¡å¿ƒåˆ†æ•°æ¥è¿›è¡Œå¼‚å¸¸æ£€æµ‹ä¸æ˜¯å”¯ä¸€çš„æ–¹æ³•ï¼Œå› ä¸ºåˆ†ç±»å™¨è¾“å‡ºçš„æ˜¯distributionï¼Œé‚£ä¹ˆå°±å¯ä»¥è®¡ç®—äº¤å‰ç†µï¼ˆcross entropyï¼‰ã€‚äº¤å‰ç†µè¶Šå¤§å°±ä»£è¡¨è¾“å‡ºè¶Šå¹³å‡ï¼Œä»£è¡¨æœºå™¨æ²¡æœ‰åŠžæ³•åŽ»è‚¯å®šè¾“å‡ºçš„å›¾ç‰‡æ˜¯å“ªä¸ªç±»åˆ«ï¼Œè¡¨ç¤ºè¾“å‡ºçš„ä¿¡å¿ƒåˆ†æ•°æ˜¯æ¯”è¾ƒä½Žã€‚æ€»ä¹‹æˆ‘ä»¬æœ‰ä¸åŒçš„æ–¹æ³•æ ¹æ®åˆ†ç±»å™¨å†³å®šå®ƒçš„ä¿¡å¿ƒåˆ†æ•°.

é‚£æˆ‘ä»¬å®žé™…æ¥åšä¸€ä¸‹ï¼Œå°±ç”¨åˆ†å¸ƒä¸­æœ€é«˜æ•°å€¼ä½œä¸ºä¿¡å¿ƒåˆ†æ•°çš„æ–¹æ³•ï¼Œç»“æžœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![image-20201105203350782](images/image-20201105203350782.png)

çŽ°åœ¨æˆ‘è¾“å…¥ä¸€å¼ è®­ç»ƒèµ„æ–™æ²¡æœ‰çš„å›¾ç‰‡ï¼ˆè·é©¬ï¼‰ï¼Œåˆ†ç±»å™¨è¾“å‡ºè·é©¬çš„ä¿¡å¿ƒåˆ†æ•°æ˜¯1.00ï¼›è¾“å…¥éœ¸å­çš„å›¾ç‰‡ï¼Œåˆ†ç±»å™¨è¾“å‡ºéœ¸å­çš„ä¿¡å¿ƒåˆ†æ•°ä¸º0.81ï¼Œè¾“å‡ºéƒ­è‘£çš„ä¿¡å¿ƒåˆ†æ•°ä¸º0.12ï¼›è¾“å…¥ä¸‰çŽ–çš„å›¾ç‰‡å’ŒæŽè€å¸ˆçš„å›¾ç‰‡ç»“æžœå°±æ˜¯ç›¸å¯¹å¾ˆåˆ†æ•£çš„ã€‚æˆ‘ä»¬å¯ä»¥å‘çŽ°ï¼Œå¦‚æžœè¾“å…¥çš„æ˜¯è¾›æ™®æ£®å®¶åº­çš„äººç‰©ï¼Œåˆ†ç±»å™¨è¾“å‡ºæ¯”è¾ƒé«˜ä¿¡å¿ƒåˆ†æ•°ã€‚å¦‚æžœè¾“å…¥ä¸æ˜¯è¾›æ™®æ£®å®¶åº­çš„äººç‰©ï¼Œåˆ†ç±»å™¨è¾“å‡ºçš„ä¿¡å¿ƒåˆ†æ•°æ˜¯æ¯”è¾ƒä½Žã€‚ä½†æ˜¯è¾“å…¥å‡‰å®«æ˜¥æ—¥çš„å›¾ç‰‡ï¼Œåˆ†ç±»å™¨è¾“å‡ºæŸ¯é˜¿ä¸‰çš„ä¿¡å¿ƒåˆ†æ•°ä¸º0.99ï¼Œæ‰€ä»¥è¿™ç§æ–¹æ³•è¿˜æ˜¯æœ‰æœ‰ä¸€äº›ç‘•ç–µçš„ã€‚

æŽ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹çœ‹ä¸åŒçš„æ•°æ®é›†ä½¿ç”¨è¿™ç§æ–¹æ³•çš„ç»Ÿè®¡ç»“æžœï¼š

![image-20201105203843250](images/image-20201105203843250.png)

æˆ‘ä»¬å¯ä»¥çœ‹åˆ°çœŸæ­£çš„æ¥è‡ªè¾›æ™®æ£®å®¶åº­çš„äººç‰©çš„ä¿¡å¿ƒåˆ†æ•°éƒ½é›†ä¸­åœ¨1.0é™„è¿‘ï¼Œä½ ä»”ç»†çœ‹ä¸Šé¢çš„å›¾æ ‡ä¸­æœ‰ä¸€äº›çº¢è‰²çš„æ•°æ®ï¼ˆåˆ†ç±»é”™è¯¯ï¼‰æ¯”è¾ƒåˆ†æ•£çš„åˆ†å¸ƒåœ¨åæ ‡è½´ä¸Šï¼Œæ‰€ä»¥è¯´åˆ†ç±»é”™è¯¯çš„æ•°æ®ä¼šå¾—åˆ°æ¯”è¾ƒä½Žçš„ä¿¡å¿ƒåˆ†æ•°ï¼Œè¿™ä¸ªæ–¹æ³•è¿˜æ˜¯æœ‰ä¸€ç‚¹ç‘•ç–µçš„ã€‚

è€Œéžè¾›æ™®æ£®å®¶åº­çš„åŠ¨æ¼«äººç‰©çš„åˆ†å¸ƒæ¯”è¾ƒåˆ†æ•£ï¼Œ90%çš„æ•°æ®éƒ½æ˜¯ä¿¡å¿ƒåˆ†æ•°æ¯”è¾ƒä½Žçš„ï¼Œåˆ†æ•£åœ¨åæ ‡è½´ä¸Šï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰10%çš„æ•°æ®ä¿¡å¿ƒåˆ†æ•°åˆ†å¸ƒåœ¨1.0é™„è¿‘ã€‚è¿™10%æ ·æœ¬ä¸æ˜¯è¾›æ™®æ£®å®¶åº­çš„äººç‰©ï¼Œä½†ç»™äº†æ¯”è¾ƒé«˜çš„åˆ†æ•°ï¼Œä¹Ÿè¯´æ˜Žè¿™ä¸ªæ–¹æ³•æ˜¯æœ‰ç‘•ç–µçš„ã€‚

æ€»çš„æ¥è¯´ï¼Œå¦‚æžœä½ è¦åšå¼‚å¸¸æ£€æµ‹çš„é—®é¢˜ï¼Œåœ¨ä½ æ‰‹ä¸Šæœ‰ä¸€ä¸ªåˆ†ç±»å™¨æˆ–è€…è¯´èƒ½trainå‡ºä¸€ä¸ªåˆ†ç±»å™¨çš„æƒ…å†µä¸‹ï¼Œè¿™åº”è¯¥æ˜¯ä½ ç¬¬ä¸€ä¸ªè¦å°è¯•çš„baselineã€‚è™½ç„¶å¾ˆç®€å•ï¼Œä½†å®žé™…ä¸Šä¸è§å¾—ç»“æžœè¡¨çŽ°ä¼šå¾ˆå·®ã€‚

### Outlook: Network for Confidence Estimation

![image-20201105204629043](images/image-20201105204629043.png)

> Terrance DeVries, Graham W. Taylor, Learning Confidence for Out-of-Distribution Detection in Neural Networks, arXiv, 2018

ä½ è®­ç»ƒä¸€ä¸ªneuron networkæ—¶ï¼Œå¯ä»¥ç›´æŽ¥è®©neuron networkè¾“å‡ºä¿¡å¿ƒåˆ†æ•°ï¼Œè¿™ä¸ªé—®é¢˜æˆ‘å…ˆä¸ç»†èŠ‚ï¼Œåœ¨è¿™é‡Œæˆ‘å…ˆå¼•ç”¨ä¸€ä¸ªæ–‡çŒ®ï¼ˆ2018å¹´çš„paperï¼‰æ˜¯æœ‰è¿™æ ·çš„æŠ€æœ¯çš„ã€‚



### More Detail

æŽ¥ä¸‹æ¥æˆ‘ä»¬è¦è®²ä¸€ä¸‹å…³äºŽä¸Šè¿°åœ¨æœ‰åˆ†ç±»æ¨¡åž‹çš„æƒ…å†µä¸‹æ ¹æ®ä¿¡å¿ƒåˆ†æ•°è¿›è¡Œå¼‚å¸¸æ£€æµ‹çš„å…·ä½“ç»†èŠ‚ï¼ŒåŒ…æ‹¬thresholdï¼ˆé˜ˆå€¼ï¼‰å¦‚ä½•å®šï¼Œå¦‚ä½•åˆ¤æ–­å¼‚å¸¸åˆ¤æ–­ç»“æžœçš„å¥½åç­‰é—®é¢˜ã€‚

é¦–å…ˆæˆ‘ä»¬å…ˆæ¥å¤ä¹ ä¸€ä¸‹**model framework**ï¼š

![image-20201106085218970](images/image-20201106085218970.png)

æˆ‘ä»¬æœ‰å¤§é‡çš„è®­ç»ƒèµ„æ–™ï¼Œä¸”è®­ç»ƒèµ„æ–™å…·æœ‰æ ‡æ³¨ï¼ˆè¾›æ™®æ£®å®¶åº­çš„äººç‰©ï¼‰ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥è®­ç»ƒä¸€ä¸ªåˆ†ç±»å™¨ã€‚ä¸ç®¡ä½ ç”¨ä»€ä¹ˆç®—æ³•ï¼Œç›®æ ‡æ˜¯å¯ä»¥ä»Žåˆ†ç±»å™¨ä¸­å¾—åˆ°å¯¹åº”å›¾ç‰‡çš„ä¿¡å¿ƒåˆ†æ•°ã€‚ç„¶åŽå°±æ ¹æ®ä¿¡å¿ƒåˆ†æ•°å»ºç«‹å¼‚å¸¸æ£€æµ‹çš„ç³»ç»Ÿï¼Œè‹¥ä¿¡å¿ƒåˆ†æ•°é«˜äºŽæŸä¸ªthresholdï¼ˆé˜€å€¼ï¼‰æ—¶å°±è®¤ä¸ºæ˜¯æ­£å¸¸ï¼Œè‹¥ä½ŽäºŽæŸä¸ªthreshold æ—¶å°±è®¤ä¸ºæ˜¯å¼‚å¸¸ã€‚

Dev Set(development set): 

> ç”¨äºŽè®­ç»ƒè¿‡ç¨‹ä¸­ï¼ŒæŒ‡å¯¼è°ƒæ•´è¶…å‚æ•°çš„æ ·æœ¬é›†ï¼Œä½¿ç”¨èµ·æ¥ç±»ä¼¼äºŽæµ‹è¯•é›†ï¼›
>
> ä»¥å‰æœºå™¨å­¦ä¹ æ•°æ®é‡å°‘ï¼Œè¶…å‚æ•°å°‘çš„æ—¶å€™å¯èƒ½æ˜¯æ²¡æœ‰è¿™ä¸ªæ ·æœ¬é›†çš„ï¼Œåªæœ‰è®­ç»ƒé›†ï¼ˆtrain setï¼‰å’Œæµ‹è¯•é›†ï¼ˆtest setï¼‰ã€‚è¿™æ—¶æµ‹è¯•é›†ä½œä¸ºéªŒè¯é›†ä½¿ç”¨ï¼›
>
> çŽ°åœ¨æ•°æ®é‡å¤šäº†ï¼Œå¯ä»¥å•ç‹¬åˆ†å‡ºä¸€éƒ¨åˆ†æ ·æœ¬ä½œä¸ºdev setï¼Œç”¨äºŽè¶…å‚æ•°è°ƒä¼˜ï¼Œæ¨¡åž‹ç»è¿‡è®­ç»ƒé›†è®­ç»ƒï¼Œå’ŒéªŒè¯é›†è°ƒä¼˜ï¼Œç„¶åŽäº¤ç»™æµ‹è¯•é›†æµ‹è¯•æ€§èƒ½ï¼›
>
> ä½œè€…ï¼šçŒ›è™Žç¥žå¨å‡¯è’‚çŒ«
> Refï¼šhttps://www.zhihu.com/question/53052465/answer/281962767
> æ¥æºï¼šçŸ¥ä¹Ž

åœ¨çŽ°åœ¨è¿™ä¸ªå¼‚å¸¸æŽ¢æµ‹ä»»åŠ¡ä¸­ï¼Œæˆ‘ä»¬éœ€è¦çš„development set éœ€è¦åŒ…å«å¤§é‡çš„imagesï¼Œè¿™äº›imageséœ€è¦è¢«æ ‡æ³¨ä¸Šæ˜¯å¦æ˜¯æ¥è‡ªè¾›æ™®æ£®å®¶åº­çš„äººç‰©ã€‚å¦å¤–ï¼Œéœ€è¦å¼ºè°ƒçš„æ˜¯åœ¨è®­ç»ƒæ—¶æ‰€æœ‰çš„æ ·æœ¬æ•°æ®éƒ½æ˜¯æ¥è‡ªè¾›æ™®æ£®å®¶åº­çš„äººç‰©ï¼Œæ ‡ç­¾æ˜¯è¾›æ™®æ£®å®¶åº­çš„å“ªä¸ªäººç‰©ã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬åœ¨åšDev Set æ—¶éœ€è¦æ¨¡æ‹Ÿæµ‹è¯•æ•°æ®é›†ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™é‡Œé¢è¿˜éœ€è¦åŒ…å«éžè¾›æ™®æ£®å®¶åº­çš„äººç‰©çš„å›¾ç‰‡ã€‚

æœ‰äº†Dev Set ä»¥åŽï¼Œæˆ‘ä»¬å°±å¯ä»¥æŠŠæˆ‘ä»¬å¼‚å¸¸æŽ¢æµ‹ç³»ç»Ÿåº”ç”¨åœ¨Dev Set ï¼Œç„¶åŽè®¡ç®—å¼‚å¸¸æŽ¢æµ‹ç³»ç»Ÿåœ¨Dev Setä¸Šçš„å¾—åˆ†æ˜¯å¤šå°‘ã€‚ç­‰ä¸‹ä¼šè¯´æ˜Žè¿™ä¸ªå¾—åˆ†å¦‚ä½•è®¡ç®—ã€‚ä½ èƒ½å¤Ÿåœ¨Dev Set è¡¡é‡ä¸€ä¸ªå¼‚å¸¸æŽ¢æµ‹ç³»ç»Ÿçš„è¡¨çŽ°ä»¥åŽï¼Œä½ å°±å¯ä»¥æ‹¿æ¥è°ƒæ•´thresholdï¼Œä»¥æ‰¾å‡ºè®©æœ€å¥½çš„threshold ã€‚

å†³å®šhyperparametersï¼ˆè¶…å‚ï¼‰ä»¥åŽï¼Œå°±æœ‰äº†ä¸€ä¸ªå¼‚å¸¸æŽ¢æµ‹çš„ç³»ç»Ÿï¼Œä½ å°±å¯ä»¥è®©å®ƒä¸Šçº¿ã€‚è¾“å…¥ä¸€å¼ å›¾ç‰‡ï¼Œç³»ç»Ÿå°±ä¼šå†³å®šæ˜¯ä¸æ˜¯è¾›æ™®æ£®å®¶åº­çš„äººç‰©ã€‚æ•´ä¸ªAnomaly Detection System æž„å»ºå°±ç»“æŸäº†ã€‚ä½†æ˜¯æˆ‘ä»¬è¿˜é—ç•™äº†ä¸€ä¸ªé—®é¢˜ï¼š

**å¦‚ä½•è®¡ç®—ä¸€ä¸ªå¼‚å¸¸ä¾¦æµ‹ç³»ç»Ÿçš„æ€§èƒ½å¥½åï¼Ÿ**

![image-20201106091601459](images/image-20201106091601459.png)

ä¸Šå›¾æ˜¯100å¼ è¾›æ™®æ£®å®¶åº­äººç‰©çš„å›¾ç‰‡ï¼ˆè“è‰²ï¼‰å’Œ5å¼ ä¸æ˜¯è¾›æ™®æ£®å®¶åº­äººç‰©çš„å›¾ç‰‡ï¼ˆçº¢è‰²ï¼‰è¾“å…¥åˆ°Anomaly Detection ä¸­å¾—åˆ°çš„Confidence Scoreã€‚ä½ ä¼šå‘çŽ°ä¸Šå›¾å·¦ä¾§æœ‰ä¸€ä¸ªè¾›æ™®æ£®å®¶åº­çš„å›¾ç‰‡çš„ä¿¡å¿ƒåˆ†æ•°ç«Ÿç„¶æ˜¯éžå¸¸ä½Žçš„ï¼Œåœ¨è¿™é‡Œå¼‚å¸¸æŽ¢æµ‹ç³»ç»ŸçŠ¯äº†ä¸€ä¸ªé”™è¯¯ï¼Œè®¤ä¸ºå®ƒä¸æ˜¯è¾›æ™®æ£®å®¶åº­çš„äººç‰©ã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œäº”å¼ éžè¾›æ™®æ£®å®¶åº­äººç‰©çš„å›¾ç‰‡çš„ä¿¡å¿ƒå¾—åˆ†å…¶å®žè¿˜æŒºé«˜çš„ï¼Œå°¤å…¶æ˜¯é­”æ³•å°‘å¥³ï¼ˆ0.998ï¼‰ã€‚åœ¨å®žè·µçš„æ—¶å€™ï¼Œå¾ˆå¤šäººéƒ½å‘çŽ°è¿™äº›å¼‚å¸¸å›¾ç‰‡ä¼šå¾—åˆ°å¾ˆé«˜çš„åˆ†æ•°ï¼Œå…¶å®žè¿™ä¸æ˜¯ç‰¹åˆ«å¤§çš„é˜»ç¢ï¼Œå› ä¸ºçœŸæ­£æ˜¯è¾›æ™®æ£®å®¶åº­çš„äººç‰©çš„ä¿¡å¿ƒåˆ†æ•°ä¼šéžå¸¸é›†ä¸­åˆ°1.0ï¼Œåªè¦å¼‚å¸¸å›¾ç‰‡æ²¡æœ‰æ­£å¸¸å›¾ç‰‡çš„ä¿¡å¿ƒåˆ†æ•°é‚£\~ä¹ˆ\~é«˜\~ï¼Œå°±è¿˜æ˜¯å¯ä»¥å¾—åˆ°æ¯”è¾ƒå¥½çš„å¼‚å¸¸æŽ¢æµ‹æ•ˆæžœçš„ã€‚

![image-20201106093433452](images/image-20201106093433452.png)

æˆ‘ä»¬æ€Žä¹ˆæ¥è¯„ä¼°ä¸€ä¸ªå¼‚å¸¸æ£€æµ‹ç³»ç»Ÿçš„å¥½åå‘¢ï¼Ÿæˆ‘ä»¬çŸ¥é“å¼‚å¸¸æ£€æµ‹å…¶å®žæ˜¯ä¸€ä¸ªäºŒå…ƒåˆ†ç±»ï¼ˆbinary classificationï¼‰çš„é—®é¢˜ã€‚åœ¨äºŒå…ƒåˆ†ç±»ä¸­æˆ‘ä»¬éƒ½æ˜¯ç”¨æ­£ç¡®çŽ‡æ¥è¡¡é‡ä¸€ä¸ªç³»ç»Ÿçš„å¥½åï¼Œä½†æ˜¯åœ¨å¼‚å¸¸æ£€æµ‹ä¸­æ­£ç¡®çŽ‡å¹¶ä¸æ˜¯ä¸€ä¸ªå¥½çš„è¯„ä¼°ç³»ç»Ÿçš„æŒ‡æ ‡ã€‚ä½ å¯èƒ½ä¼šå‘çŽ°ä¸€ä¸ªç³»ç»Ÿå¾ˆå¯èƒ½æœ‰å¾ˆé«˜çš„æ­£ç¡®çŽ‡ï¼Œä½†å…¶å®žè¿™ä¸ªç³»ç»Ÿä»€ä¹ˆäº‹éƒ½æ²¡æœ‰åšã€‚ä¸ºä»€ä¹ˆè¿™æ ·å‘¢ï¼Ÿå› ä¸ºåœ¨å¼‚å¸¸æ£€æµ‹çš„é—®é¢˜ä¸­æ­£å¸¸çš„æ•°æ®å’Œå¼‚å¸¸çš„æ•°æ®ä¹‹é—´çš„æ¯”ä¾‹æ˜¯éžå¸¸æ‚¬æ®Šçš„ã€‚åœ¨è¿™ä¸ªä¾‹å­é‡Œé¢ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†æ­£å¸¸çš„å›¾ç‰‡æœ‰ä¸€ç™¾å¼ ï¼Œå¼‚å¸¸çš„å›¾ç‰‡æœ‰äº”å¼ ã€‚è¿™ä¼šé€ æˆåªç”¨å‡†ç¡®çŽ‡è¡¡é‡ç³»ç»Ÿçš„å¥½åä¼šå¾—åˆ°éžå¸¸å¥‡æ€ªçš„ç»“æžœçš„ã€‚

ä¸¾ä¸ªæ —å­ï¼Œå¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬å°†threshold $Î»$ è®¾ä¸º**0.3å’Œ0.5**ã€‚ $Î»$ ä»¥ä¸Šè®¤ä¸ºæ˜¯æ­£å¸¸çš„ï¼Œ $Î»$ ä»¥ä¸‹è®¤ä¸ºæ˜¯å¼‚å¸¸çš„ã€‚è¿™æ—¶ä½ ä¼šå‘çŽ°è¿™ä¸ªç³»ç»Ÿçš„æ­£ç¡®çŽ‡**éƒ½æ˜¯**95.2%ï¼Œæ‰€ä»¥å¼‚å¸¸ä¾¦æµ‹é—®é¢˜ä¸­ä¸ä¼šç”¨æ­£ç¡®çŽ‡æ¥ç›´æŽ¥å½“åšè¯„ä¼°æŒ‡æ ‡ã€‚

é¦–å…ˆæˆ‘ä»¬è¦çŸ¥é“åœ¨å¼‚å¸¸æ£€æµ‹ä¸­æœ‰ä¸¤ç§é”™è¯¯ï¼šä¸€ç§é”™è¯¯æ˜¯å¼‚å¸¸çš„æ•°æ®è¢«åˆ¤æ–­ä¸ºæ­£å¸¸çš„æ•°æ®ï¼Œå¦å¤–ä¸€ç§æ˜¯æ­£å¸¸çš„æ•°æ®è¢«åˆ¤ä¸ºå¼‚å¸¸çš„æ•°æ®ã€‚å‡è®¾æˆ‘ä»¬å°† $Î»$ è®¾ä¸º0.5ï¼ˆ0.5ä»¥ä¸Šè®¤ä¸ºæ˜¯æ­£å¸¸çš„æ•°æ®ï¼Œ0.5ä»¥ä¸‹è®¤ä¸ºæ˜¯å¼‚å¸¸çš„æ•°æ®ï¼‰ï¼Œè¿™æ—¶å°±å¯ä»¥è®¡ç®—æœºå™¨åœ¨è¿™ä¸¤ç§é”™è¯¯ä¸Šåˆ†åˆ«èŒƒäº†å¤šå°‘é”™è¯¯ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![image-20201106094357272](images/image-20201106094357272.png)

æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœºå™¨åˆ¤æ–­å‡ºçŽ°äº†ä¸¤ç±»é”™è¯¯ï¼Œmissäº†4ä¸ªanomaly dataï¼Œfalse alarmäº†1ä¸ªnormal data ã€‚

![image-20201106094500582](images/image-20201106094500582.png)

è‹¥æˆ‘ä»¬å°†threshold åˆ‡åœ¨æ¯”0.8ç¨é«˜çš„éƒ¨åˆ†ï¼Œå¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œè¿™æ—¶ä¼šå‘çŽ°åœ¨äº”å¼ å¼‚å¸¸çš„å›¾ç‰‡ä¸­ï¼Œå…¶ä¸­æœ‰ä¸¤å¼ è®¤ä¸ºæ˜¯å¼‚å¸¸çš„å›¾ç‰‡ï¼Œå…¶ä½™ä¸‰ç§è¢«åˆ¤æ–­ä¸ºæ­£å¸¸çš„å›¾ç‰‡ï¼›åœ¨ä¸€ç™¾å¼ æ­£ç¡®çš„å›¾ç‰‡ä¸­ï¼Œå…¶ä¸­æœ‰å…­å¼ å›¾ç‰‡è¢«è®¤ä¸ºæ˜¯å¼‚å¸¸çš„å›¾ç‰‡ï¼Œå…¶ä½™ä¹åå››å¼ å›¾ç‰‡è¢«åˆ¤æ–­ä¸ºæ­£å¸¸çš„å›¾ç‰‡ã€‚

é‚£ä¸€ä¸ªç³»ç»Ÿæ¯”è¾ƒå¥½å‘¢ï¼Ÿå…¶å®žä½ æ˜¯å¾ˆéš¾å›žç­”è¿™ä¸ªé—®é¢˜ã€‚æœ‰äººå¯èƒ½ä¼šå¾ˆç›´è§‰çš„è®¤ä¸ºï¼šå½“é˜€å€¼ä¸º0.5æ—¶æœ‰äº”ä¸ªé”™è¯¯ï¼Œé˜€å€¼ä¸º0.8æ—¶æœ‰ä¹ä¸ªé”™è¯¯ï¼Œæ‰€ä»¥è®¤ä¸ºå·¦è¾¹çš„ç³»ç»Ÿå¥½ï¼Œå³è¾¹çš„ç³»ç»Ÿå·®ã€‚ä½†å…¶å®žä¸€ä¸ªç³»ç»Ÿæ˜¯å¥½è¿˜æ˜¯åï¼Œå–å†³ä½ è§‰å¾—false alarmæ¯”è¾ƒä¸¥é‡è¿˜æ˜¯missingæ¯”è¾ƒä¸¥é‡ã€‚

![image-20201106094613261](images/image-20201106094613261.png)

æ‰€ä»¥ä½ åœ¨åšå¼‚å¸¸æŽ¢æµ‹æ—¶ï¼Œå¯èƒ½éœ€è¦æœ‰Cost Table å‘Šè¯‰ä½ æ¯ä¸€ç§é”™è¯¯æœ‰å¤šå¤§çš„Cost ã€‚å¦‚ä¸Šå›¾æ‰€ç¤ºæˆ‘ä»¬å°†ä¸¤ä¸ªCost Table åˆ†åˆ«è®¡ç®—ä¸€ä¸‹threshold $Î»$ ä¸º0.5å’Œ0.8çš„ä¸¤ä¸ªç³»ç»Ÿçš„cost ï¼Œå‘çŽ°å–ä¸åŒçš„çš„cost è¡¡é‡æ ‡å‡†ï¼Œå°±ä¼šæœ‰ä¸åŒçš„åˆ¤å®šç»“æžœã€‚

ä¸ºä»€ä¹ˆè¦è¿™æ ·å‘¢ï¼Œä¸¾ä¸€ä¸ªå½¢è±¡ä¸€ç‚¹çš„æ —å­ï¼Œå¦‚æžœè¯´ä½ ä»Šå¤©è¦åšç™Œç—‡æ£€æµ‹çš„å¼‚å¸¸æ£€æµ‹ï¼Œä¸Žè¯¯åˆ¤æ¯”èµ·æ¥ï¼Œæˆ‘ä»¬æ˜¾ç„¶æ›´åŠ ä¸èƒ½å®¹å¿missingï¼Œå¦‚æžœä¸€ä¸ªå…¶å®žæœ‰ç™Œç—‡çš„äººè¢«ç³»ç»Ÿmiss äº†ï¼Œè€½è¯¯äº†æœ€ä½³æ²»ç–—æ—¶é—´ï¼Œå°±æ˜¯ç”Ÿå‘½çš„ä»£ä»·ã€‚

å…¶å®žè¿˜æœ‰å¾ˆå¤šè¡¡é‡å¼‚å¸¸æ£€æµ‹ç³»ç»Ÿçš„æŒ‡æ ‡ï¼Œè¿™é‡Œå°±ä¸ç»†è®²è¿™äº›ï¼Œæœ‰ä¸€ä¸ªå¸¸ç”¨çš„æŒ‡æ ‡ä¸ºArea under ROC curveã€‚è‹¥ä½¿ç”¨è¿™ç§è¡¡é‡çš„æ–¹å¼ï¼Œä½ å°±ä¸éœ€è¦å†³å®šthreshold ï¼Œè€Œæ˜¯çœ‹ä½ å°†æµ‹è¯•é›†çš„ç»“æžœåšä¸€ä¸ªæŽ’åºï¼ˆé«˜åˆ†è‡³ä½Žåˆ†ï¼‰ï¼Œæ ¹æ®è¿™ä¸ªæŽ’åºæ¥å†³å®šè¿™ä¸ªç³»ç»Ÿå¥½è¿˜æ˜¯ä¸å¥½ã€‚



### Possible Issue

![image-20201106095719612](images/image-20201106095719612.png)

å¦‚æžœæˆ‘ä»¬ç›´æŽ¥ç”¨ä¸€ä¸ªåˆ†ç±»å™¨æ¥æ£€æµ‹è¾“å…¥çš„æ•°æ®æ˜¯ä¸æ˜¯å¼‚å¸¸çš„ï¼Œå½“ç„¶è¿™å¹¶ä¸æ˜¯ä¸€ç§å¾ˆå¼±çš„æ–¹æ³•ï¼Œä½†æ˜¯æœ‰æ—¶å€™æ— æ³•ç»™ä½ ä¸€ä¸ªperfect çš„ç»“æžœï¼Œæˆ‘ä»¬ç”¨ä¸Šå›¾æ¥è¯´æ˜Žç”¨classifier åšå¼‚å¸¸ä¾¦æµ‹æ—¶æœ‰å¯èƒ½ä¼šé‡åˆ°çš„é—®é¢˜ã€‚å‡è®¾çŽ°åœ¨åšä¸€ä¸ªçŒ«å’Œç‹—çš„åˆ†ç±»å™¨ï¼Œå°†å±žäºŽçŒ«ðŸ±çš„ä¸€ç±»æ”¾åœ¨ä¸€è¾¹ï¼Œå±žäºŽç‹—ðŸ•çš„ä¸€ç±»æ”¾åœ¨ä¸€è¾¹ã€‚è‹¥è¾“å…¥ä¸€ç¬”èµ„æ–™å³æ²¡æœ‰çŒ«çš„ç‰¹å¾ä¹Ÿæ²¡æœ‰ç‹—çš„ç‰¹å¾ï¼ˆè‰æ³¥é©¬ï¼Œé©¬èŽ±è²˜ï¼‰ï¼Œæœºå™¨ä¸çŸ¥é“è¯¥æ”¾åœ¨å“ªä¸€è¾¹ï¼Œå°±å¯èƒ½æ”¾åœ¨è¿™ä¸ªboundaryä¸Šï¼Œå¾—åˆ°çš„ä¿¡æ¯åˆ†æ•°å°±æ¯”è¾ƒä½Žï¼Œä½ å°±çŸ¥é“è¿™äº›èµ„æ–™æ˜¯å¼‚å¸¸çš„ã€‚

ä½ æœ‰å¯èƒ½ä¼šé‡åˆ°è¿™æ ·çš„çŠ¶å†µï¼šæœ‰äº›èµ„æ–™ä¼šæ¯”çŒ«æ›´åƒçŒ«ï¼ˆè€è™Žï¼‰ï¼Œæ¯”ç‹—è¿˜åƒç‹—ï¼ˆç‹¼ï¼‰ã€‚æœºå™¨åœ¨åˆ¤æ–­çŒ«å’Œç‹—æ—¶æ˜¯æŠ“ä¸€äº›çŒ«çš„ç‰¹å¾è·Ÿç‹—çš„ç‰¹å¾ï¼Œä¹Ÿè®¸è€è™Žåœ¨çŒ«çš„ç‰¹å¾ä¸Šä¼šæ›´å¼ºçƒˆï¼Œç‹¼åœ¨ç‹—çš„ç‰¹å¾ä¸Šä¼šæ›´å¼ºçƒˆã€‚å¯¹äºŽæœºå™¨æ¥è¯´è™½ç„¶æœ‰äº›èµ„æ–™åœ¨è®­ç»ƒæ—¶æ²¡æœ‰çœ‹è¿‡ï¼ˆå¼‚å¸¸ï¼‰ï¼Œä½†æ˜¯å®ƒæœ‰éžå¸¸å¼ºçš„ç‰¹å¾ä¼šç»™åˆ†ç±»å™¨å¾ˆå¤§çš„ä¿¡å¿ƒçœ‹åˆ°æŸä¸€ç§ç±»åˆ«ã€‚

![image-20201106095849813](images/image-20201106095849813.png)

å†æ¯”å¦‚ï¼Œåˆšæ‰åšè¾›æ™®æ£®å®¶åº­äººç‰©çš„å¼‚å¸¸æ£€æµ‹çš„æ—¶å€™ï¼Œé»„è‰²çš„é­”æ³•å°‘å¥³å’Œå°æ¨±éƒ½ç»™äº†æ¯”è¾ƒé«˜çš„ä¿¡å¿ƒåˆ†æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬çŒœæµ‹åˆ†ç±»å™¨æ˜¯çœ‹åˆ°é»„è‰²å°±ç»™å¾ˆé«˜çš„åˆ†æ•°ï¼Œæˆ‘ä»¬å°±æŠŠä¸‰çŽ–çš„è„¸å’Œå¤´å‘æ¶‚é»„ï¼Œæžœç„¶åˆ†æ•°æš´å¢žï¼Œåœ¨è€å¸ˆçš„è„¸ä¸Šæ¶‚é»„ï¼Œæ•ˆæžœä¹Ÿæ˜¯æ˜¾è‘—çš„ã€‚ðŸ¤£æ‰€ä»¥è¿™äº›éƒ½æ˜¯å¼‚å¸¸æ£€æµ‹çš„é—®é¢˜ã€‚

### To Learn More

![image-20201106100114896](images/image-20201106100114896.png)

å½“ç„¶æœ‰äº›æ–¹æ³•å¯ä»¥è§£è¿™ä¸ªé—®é¢˜ï¼Œè¿™é‡Œåˆ—ä¸€äº›æ–‡çŒ®ç»™å¤§å®¶è¿›è¡Œå‚è€ƒã€‚

> Kimin Lee, Honglak Lee, Kibok Lee, Jinwoo Shin, Training Confidence-calibrated Classifiers for Detecting Out-of-Distribution Samples, ICLR 2018

å…¶ä¸­çš„ä¸€ä¸ªè§£å†³æ–¹æ³•æ˜¯ï¼šå‡è®¾æˆ‘ä»¬å¯ä»¥æ”¶é›†åˆ°ä¸€äº›å¼‚å¸¸çš„æ ·æœ¬ï¼Œæˆ‘ä»¬å¯ä»¥æ•™æœºå™¨çœ‹åˆ°æ­£å¸¸æ ·æœ¬æ—¶ä¸è¦åªå­¦ä¼šåˆ†ç±»è¿™ä»¶äº‹æƒ…ï¼Œè¦å­¦ä¼šä¸€è¾¹åšåˆ†ç±»ä¸€è¾¹çœ‹åˆ°æ­£å¸¸çš„èµ„æ–™ä¿¡å¿ƒåˆ†æ•°å°±é«˜ï¼Œçœ‹åˆ°å¼‚å¸¸çš„èµ„æ–™å°±è¦ç»™å‡ºä½Žçš„ä¿¡å¿ƒåˆ†æ•°ã€‚

> Mark Kliger, Shachar Fleishman, Novelty Detection with GAN, arXiv, 2018

ä½†æ˜¯ä¼šé‡åˆ°çš„é—®é¢˜æ˜¯ï¼šå¾ˆå¤šæ—¶å€™ä¸å®¹æ˜“æ”¶é›†åˆ°å¼‚å¸¸çš„æ•°æ®ã€‚æœ‰äººå°±æƒ³å‡ºäº†ä¸€ä¸ªç¥žå¥‡çš„è§£å†³æ–¹æ³•å°±æ˜¯ï¼šæ—¢ç„¶æ”¶é›†ä¸åˆ°å¼‚å¸¸çš„æ•°æ®ï¼Œé‚£æˆ‘ä»¬å°±é€šè¿‡Generative Model æ¥ç”Ÿæˆå¼‚å¸¸çš„æ•°æ®ã€‚è¿™æ ·ä½ å¯èƒ½é‡åˆ°çš„é—®é¢˜æ˜¯ï¼šç”Ÿæˆçš„æ•°æ®å¤ªåƒæ­£å¸¸çš„èµ„æ–™ï¼Œé‚£è¿™æ ·å°±ä¸æ˜¯æˆ‘ä»¬æ‰€éœ€è¦çš„ã€‚æ‰€ä»¥è¿˜è¦åšä¸€äº›ç‰¹åˆ«çš„constraint ï¼Œè®©ç”Ÿæˆçš„èµ„æ–™æœ‰ç‚¹åƒæ­£å¸¸çš„èµ„æ–™ï¼Œä½†æ˜¯åˆè·Ÿæ­£å¸¸çš„èµ„æ–™åˆæ²¡æœ‰å¾ˆåƒã€‚æŽ¥ä¸‹æ¥å°±å¯ä»¥ä½¿ç”¨ä¸Šé¢çš„æ–¹æ³•æ¥è®­ç»ƒä½ çš„classifier ã€‚



## Case 2ï¼šWithout Labels

åœ¨ç¬¬äºŒç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ²¡æœ‰classifier ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬æ”¶é›†åˆ°çš„æ•°æ®æ²¡æœ‰label ã€‚

### Twitch Play PokÃ©mon

![image-20201106113741909](images/image-20201106113741909.png)

è¿™æ˜¯ä¸€ä¸ªçœŸå®žçš„Twitch Plays PokÃ©monä¾‹å­ï¼Œè¿™ä¸ªçš„ä¾‹å­æ˜¯è¿™æ ·çš„ï¼šæœ‰äººå¼€äº†ä¸€ä¸ªå®å¯æ¢¦çš„æ¸¸æˆï¼Œå…¨ä¸–ç•Œçš„äººéƒ½å¯ä»¥è¿žæŽ¥ä¸€èµ·çŽ©è¿™ä¸ªå®å¯æ¢¦çš„æ¸¸æˆã€‚å³è¾¹çš„æ¡†æ˜¯æ¯ä¸€ä¸ªäººéƒ½åœ¨è¾“å…¥æŒ‡ä»¤åŒæ—¶æ“æŽ§è¿™ä¸ªæ¸¸æˆï¼Œè¿™ä¸ªæ¸¸æˆæœ€å¤šçºªå½•å¤§æ¦‚æœ‰å…«ä¸‡äººåŒæ—¶çŽ©è¿™ä¸ªæ¸¸æˆã€‚å½“å¤§å®¶éƒ½åœ¨åŒæ—¶æ“ä½œåŒä¸€ä¸ªè§’è‰²æ—¶ï¼ŒçŽ©èµ·æ¥å…¶å®žæ˜¯ç›¸å½“å´©æºƒçš„ã€‚ï¼ˆPaperclip2019å¹´åšçš„è§£å¯†æ´»åŠ¨ä¸­çš„ä¸€éƒ¨åˆ†ä¼¼ä¹Žæ˜¯åœ¨æ¨¡ä»¿è¿™ä¸ªæ¸¸æˆæ¨¡å¼ï¼‰

è¿™ä¸ªæ¸¸æˆæ˜¯å¤šå¹´å‰è¿›è¡Œçš„ï¼Œä¸è¿‡çŽ°åœ¨twitch ä¸Šå±…ç„¶è¿˜æœ‰å‡çº§ç‰ˆçš„ï¼Œç›´æ’­åœ°å€ï¼š

>  https://www.twitch.tv/twitchplayspokemon

ä»¥ä¸‹æ˜¯æˆ‘å½•åˆ¶çš„ä¸€å°æ®µgifï¼š

![Twitch-Plays-PokÃ©mon.gif](images/Twitch-Plays-PokÃ©mon.gif)

![img](images/image-20201106113742999.png)

äººä»¬çŽ©çš„æ—¶å€™å°±éžå¸¸çš„å´©æºƒï¼Œå‘çŽ°æ ¹æœ¬çŽ©ä¸ä¸‹åŽ»ï¼Œé‚£ä¹ˆå´©æºƒçš„åŽŸå› æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿå¯èƒ½æ˜¯å› ä¸ºæœ‰Trollï¼ˆç½‘ç»œå°ç™½ï¼Ÿï¼‰ã€‚è¿™äº›äººå¯èƒ½æ ¹æœ¬å°±ä¸ä¼šçŽ©ï¼Œæ‰€ä»¥å¤§å®¶éƒ½æ²¡æœ‰åŠžæ³•ç»§ç»­çŽ©ä¸‹åŽ»ï¼›æˆ–è€…å¯èƒ½è§‰å¾—å¾ˆæœ‰è¶£å°±ä¹±æŒ‰æŒ‰é”®ï¼›æˆ–è€…æ˜¯ä¸çŸ¥åçš„æ¶æ„ï¼Œä¸æƒ³è®©å¤§å®¶ç»“æŸè¿™ä¸ªæ¸¸æˆï¼ˆè„šæœ¬å°å­ï¼‰ã€‚äººä»¬ç›¸ä¿¡æœ‰ä¸€äº›Troll æ½œè—åœ¨äººä»¬å½“ä¸­ï¼Œä»–ä»¬æƒ³è¦é˜»æŒ æ¸¸æˆçš„è¿›è¡Œã€‚

å‡å®šå¤šæ•°çŽ©å®¶æ˜¯æƒ³è¦é€šå…³çš„ï¼Œé‚£æˆ‘ä»¬å°±å¯ä»¥ç”¨å¼‚å¸¸æ£€æµ‹çš„æŠ€æœ¯ï¼Œæ”¶é›†æ‰€æœ‰çŽ©å®¶çš„è¡Œä¸ºï¼ˆè®­ç»ƒæ•°æ®ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥ä»Žå¤šæ•°çŽ©å®¶çš„è¡Œä¸ºçŸ¥é“æ­£å¸¸çŽ©å®¶çš„è¡Œä¸ºæ˜¯å’‹æ ·çš„ï¼Œç„¶åŽä¾¦æµ‹å‡ºå¼‚å¸¸çš„çŽ©å®¶ï¼ˆTrollï¼‰ã€‚



### Problem Formulation 

![image-20201106183701173](images/image-20201106183701173.png)

æˆ‘ä»¬éœ€è¦ä¸€äº›è®­ç»ƒçš„æ ·æœ¬ï¼š $\{x^1,x^2,...,x^N\}$ ï¼Œæ¯ä¸€ä¸ª $x^i$ ä»£è¡¨ä¸€ä¸ªçŽ©å®¶ï¼Œå¦‚æžœæˆ‘ä»¬ä½¿ç”¨machine learning çš„æ–¹æ³•æ¥æ±‚è§£è¿™ä¸ªé—®é¢˜ï¼Œé¦–å…ˆè¿™ä¸ªçŽ©å®¶è¦èƒ½å¤Ÿè¡¨ç¤ºä¸ºfeature vector ã€‚ä¸¾ä¸ªä¾‹å­ï¼šå‘é‡çš„ç¬¬ä¸€ç»´å¯ä»¥æ˜¯çŽ©å®¶è¯´åžƒåœ¾è¯çš„é¢‘çŽ‡ï¼Œç¬¬äºŒç»´æ˜¯ç»Ÿè®¡çŽ©å®¶æ— æ”¿åºœçŠ¶æ€å‘è¨€ï¼Œå¯ä»¥æƒ³è±¡æœ‰å¯èƒ½æ˜¯è¿™æ ·çš„ï¼Œä¸€ä¸ªçŽ©å®¶è¶Šæ˜¯å–œæ¬¢åœ¨æ— æ”¿åºœçŠ¶æ€ä¸‹å‘è¨€ï¼Œå°±è¶Šæœ‰å¯èƒ½æ˜¯æžç ´åçš„ã€‚

è¿™ä¸ªæ•°æ®é›†æ˜¯çœŸå®žå­˜åœ¨çš„ï¼š

> https://github.com/ahaque/twitch-troll-detection (Albert Haque)

æˆ‘ä»¬çŽ°åœ¨åªæœ‰å¤§é‡çš„è®­ç»ƒæ•°æ®ï¼Œä½†æ˜¯æ²¡æœ‰labelã€‚æˆ‘ä»¬åˆšæ‰å¯ä»¥æ ¹æ®åˆ†ç±»å™¨çš„conferenceæ¥åˆ¤æ–­æ˜¯ä¸æ˜¯å¼‚å¸¸çš„èµ„æ–™ï¼Œæˆ‘ä»¬åœ¨æ²¡æœ‰classifierçš„æƒ…å†µä¸‹å¯ä»¥å»ºç«‹ä¸€ä¸ªæ¨¡åž‹ï¼Œè¿™ä¸ªæ¨¡åž‹æ˜¯å‘Šè¯‰æˆ‘ä»¬P(x)çš„å‡ çŽ‡æœ‰å¤šå¤§ï¼ˆæ ¹æ®è®­ç»ƒæ•°æ®ï¼Œæ‰¾ä¸€ä¸ªå‡ çŽ‡æ¨¡åž‹ï¼Œè¿™ä¸ªæ¨¡åž‹å¯ä»¥å‘Šè¯‰æˆ‘ä»¬æŸä¸€ç§è¡Œä¸ºå‘ç”Ÿçš„æ¦‚çŽ‡æœ‰å¤šå¤§ï¼‰ã€‚å½“æˆ‘ä»¬æœ‰äº†æ¨¡åž‹P ï¼Œæˆ‘ä»¬å°±å¯ä»¥å°†çŽ©å®¶çš„ç‰¹å¾å‘é‡è¾“å…¥æ¨¡åž‹ï¼Œå¾—åˆ°ä¸€ä¸ªå‡ çŽ‡ï¼ˆå°±æ˜¯çŽ°å®žæƒ…å†µä¸­å‘ç”Ÿè¿™åçŽ©å®¶çš„åŠ¨ä½œçš„æ¦‚çŽ‡ï¼‰ï¼Œå¦‚æžœè¿™ä¸ªå‡ çŽ‡å¤§äºŽthreshold ï¼Œå°±è®¤ä¸ºæ˜¯æ­£å¸¸çŽ©å®¶ï¼Œåä¹‹åˆ™åˆ¤å®šä¸ºå¼‚å¸¸çŽ©å®¶ã€‚ç»¼ä¸Šæ‰€è¿°æˆ‘ä»¬çš„é—®é¢˜çš„è§£å†³æ–¹æ¡ˆå°±è¢«å½¢å¼åŒ–ä¸ºä¸‹å›¾ï¼š

![image-20201106190441159](images/image-20201106190441159.png)

è¿™ä¸ªæ¨¡åž‹å¯ä»¥é€šè¿‡ç”Ÿæˆæ¨¡åž‹çš„æ–¹å¼æ¥æ‰¾ï¼Œæ¯”å¦‚è¯´Gaussian Distribution Model ï¼Œæˆ‘ä»¬å‡å®šçŽ©å®¶æ•°æ®æ˜¯åœ¨ç‰¹å¾ç©ºé—´ä¸­ç¬¦åˆé«˜æ–¯åˆ†å¸ƒï¼Œé‚£æˆ‘ä»¬å¯ä»¥é€šè¿‡çŽ°æœ‰æ•°æ®è®¡ç®—å‡ºè¿™ä¸ªåˆ†å¸ƒæ¨¡åž‹çš„ $Î¼$ å’Œ $âˆ‘$ ï¼Œå°±å¾—åˆ°è¿™ä¸ªæ¨¡åž‹äº†ï¼Œç„¶åŽæˆ‘ä»¬å°±å¯ä»¥æŒ‰ä¸Šè¿°è¿›è¡Œæ•°æ®è¾“å…¥ï¼Œåšåˆ¤å®šäº†ã€‚



![image-20201106190537233](images/image-20201106190537233.png)

å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œè¿™æ˜¯ä¸€ä¸ªçœŸå®žçš„èµ„æ–™ï¼Œå‡è®¾æ¯ä¸€ä¸ªçŽ©å®¶å¯ä»¥ç”¨äºŒç»´çš„å‘é‡æ¥æè¿°ï¼ˆä¸€ä¸ªæ˜¯è¯´åžƒåœ¾è¯çš„å‡ çŽ‡ï¼Œä¸€ä¸ªæ˜¯æ— æ”¿åºœçŠ¶æ€å‘è¨€çš„å‡ çŽ‡ï¼‰ã€‚æˆ‘ä»¬å¯ä»¥è§‚å¯Ÿåˆ°ï¼Œå–œæ¬¢åœ¨æ— æ”¿åºœçŠ¶æ€å‘è¨€çš„çŽ©å®¶å å¤šæ•°ï¼Œå–œæ¬¢è¯´è¾£é¸¡è¯çš„çŽ©å®¶å å°‘æ•°ï¼Œç»¼ä¸Šï¼Œæˆ‘ä»¬ç›´è§‚çš„ç†è§£æ˜¯æ­£å¸¸çŽ©å®¶åº”è¯¥æ˜¯å–œæ¬¢åœ¨æ— æ”¿åºœçŠ¶æ€å‘è¨€ï¼Œè€Œæ¯”è¾ƒå°‘è¯´è¾£é¸¡è¯çš„ã€‚æ‰€ä»¥æˆ‘ä»¬çš„æ¨¡åž‹ $P(x)$ çš„ç»“æžœåº”è¯¥ç¬¦åˆè¿™æ ·çš„æè¿°ï¼Œå¦‚ä¸Šå›¾å³ä¸Šè§’ã€‚

psï¼šæ°‘ä¸»çŠ¶æ€ï¼šç»Ÿè®¡ä¸€æ®µæ—¶é—´å†…çš„çŽ©å®¶æŒ‡ä»¤æ•°ï¼Œé€‰å–æ•°é‡æœ€å¤šçš„ä¸€ä¸ªæ‰§è¡Œï¼›æ— æ”¿åºœçŠ¶æ€ï¼šä¸€æ®µæ—¶é—´å†…æ‰€æœ‰çš„æŒ‡ä»¤ä¸­éšæœºpick ä¸€ä¸ªæ‰§è¡Œã€‚

é‚£ä¸ºä»€ä¹ˆä¼šå‡ºçŽ°è¿™ç§æƒ…å†µå‘¢ï¼Œæˆ‘ä»¬æ¥ç®€å•åˆ†æžä¸€ä¸‹ã€‚äº‹å®žä¸Šå¾ˆå¤šäººå¼ºçƒˆæ”¯æŒæ— æ”¿åºœçŠ¶æ€ï¼Œå¼ºçƒˆåå¯¹æ°‘ä¸»çŠ¶æ€ï¼Œæ‰€ä»¥è¿™ä¸ªæ¸¸æˆå¤šæ•°æ˜¯åœ¨æ— æ”¿åºœçŠ¶æ€ä¸‹è¿›è¡Œã€‚å‡è®¾ä¸€ä¸ªçŽ©å®¶ä¸è€ƒè™‘è‡ªå·±æ˜¯è¦åœ¨ä»€ä¹ˆçŠ¶æ€ä¸‹å‘è¨€ï¼Œå¤§å¤šæ•°äººæœ‰å…«æˆçš„å‡ çŽ‡æ˜¯åœ¨æ— æ”¿åºœä¸‹è¿›è¡Œå‘è¨€ï¼Œæœ‰äººè§‰å¾—å¤šæ•°Troll æ˜¯åœ¨æ°‘ä¸»çŠ¶æ€ä¸‹å‘è¨€ï¼Œå› ä¸ºè¿›å…¥äº†æ°‘ä¸»çŠ¶æ€ï¼Œåªè¦Troll å¤šå‘è¨€å°±èƒ½å¤Ÿè®©ä»–çš„è¡Œä¸ºè¢«é€‰ä¸­çš„æ¦‚çŽ‡æ”¾å¤§ï¼Œæ‰€ä»¥å°ç™½ä¼šç‰¹åˆ«å–œæ¬¢åœ¨æ°‘ä¸»çŠ¶æ€ä¸‹å‘è¨€ã€‚

ä»Žè¿™ä¸ªå›¾ä¸Šå¯ä»¥å¾ˆç›´è§‰çš„çœ‹å‡ºï¼ˆå³ä¸Šè§’çš„ä¸‰ä¸ªç‚¹ï¼‰ä¸€ä¸ªçŽ©å®¶è½åœ¨è¯´åžƒåœ¾çš„è¯å‡ çŽ‡ä½Žï¼Œé€šå¸¸åœ¨æ— æ”¿åºœçŠ¶æ€ä¸‹å‘è¨€ï¼Œè¿™ä¸ªçŽ©å®¶æœ‰å¯èƒ½æ˜¯ä¸€ä¸ªæ­£å¸¸çš„çŽ©å®¶ï¼Œ $P(x)$ å¤§ã€‚å‡è®¾æœ‰çŽ©å®¶è½åœ¨æœ‰äº”æˆå·¦å³çš„å‡ çŽ‡è¯´åžƒåœ¾è¯ï¼ŒäºŒæˆçš„å‡ çŽ‡åœ¨æ— æ”¿åºœçŠ¶æ€ä¸‹å‘è¨€ï¼›æˆ–è€…è½åœ¨æœ‰ä¸ƒæˆå·¦å³çš„å‡ çŽ‡è¯´åžƒåœ¾è¯ï¼Œä¸ƒæˆçš„å‡ çŽ‡åœ¨æ— æ”¿åºœçŠ¶æ€ä¸‹å‘è¨€ï¼Œæ˜¾ç„¶è¿™ä¸ªçŽ©å®¶æ¯”è¾ƒæœ‰å¯èƒ½æ˜¯ä¸€ä¸ªä¸æ­£å¸¸çš„çŽ©å®¶ï¼Œ $P(x)$ å°ã€‚

æˆ‘ä»¬ç›´è§‰ä¸Šæ˜Žç™½è¿™ä»¶äº‹æƒ…ï¼Œä½†æ˜¯æˆ‘ä»¬ä»ç„¶å¸Œæœ›ç”¨ä¸€ä¸ªæ•°å€¼åŒ–çš„æ–¹æ³•å‘Šè¯‰æˆ‘ä»¬çŽ©å®¶è½åœ¨å“ªé‡Œä¼šæ›´åŠ çš„å¼‚å¸¸ã€‚



### Maximum Likelihood

è¿™é‡Œæ‰€æŒ‡æ•°å€¼åŒ–çš„æ–¹æ³•æˆ‘ä»¬éœ€è¦ç”¨åˆ°Likelihood çš„æ¦‚å¿µï¼ˆpsï¼šå¦‚æžœä½ å­¦è¿‡æŽè€å¸ˆçš„MLçš„**[è¿™ä¸€èŠ‚è¯¾](https://youtu.be/fZAZUYEeIMg)**ä½ åº”è¯¥å·²ç»çŸ¥é“è¿™ä¸ªæ¦‚å¿µï¼‰ï¼š

![image-20201108134242825](images/image-20201108134242825.png)

- å‡è®¾æˆ‘ä»¬çš„æ•°æ®æ˜¯ä»Žä¸€ä¸ªprobability density functionï¼ˆæ¦‚çŽ‡å¯†åº¦å‡½æ•°ï¼‰ $f_{\theta}(x)$  ä¸­sampleå‡ºæ¥çš„
  - Î¸ æ˜¯æ¦‚çŽ‡å¯†åº¦å‡½æ•°çš„å‚æ•°ï¼Œæ˜¯æœªçŸ¥çš„ï¼Œæ˜¯æˆ‘ä»¬è¦ä»Žæ•°æ®ä¸­å­¦ä¹ å‡ºæ¥çš„
  - Î¸ å°†å†³å®šæˆ‘ä»¬æ¦‚çŽ‡å¯†åº¦å‡½æ•°çš„å½¢çŠ¶

- çŽ°åœ¨æˆ‘ä»¬è¦åšçš„äº‹å°±æ˜¯æ‰¾å‡ºè¿™ä¸ªæ¦‚çŽ‡å¯†åº¦å‡½æ•°ç©¶ç«Ÿé•¿ä»€ä¹ˆæ ·å­

åœ¨æ‰¾è¿™ä¸ªæ¦‚çŽ‡å¯†åº¦å‡½æ•°çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªè¡¡é‡æ–¹æ³•ï¼Œæ¥è¡¡é‡å½“å‰æ‰¾åˆ°çš„è¿™æ¦‚çŽ‡å¯†åº¦å‡½æ•°çš„å¥½åï¼Œæˆ‘ä»¬å°±æ˜¯ç”¨Likelihood ï¼Œè¿™ä¸ªä¼¼ç„¶å‡½æ•°çš„æ¦‚å¿µå’ŒæŸå¤±å‡½æ•°æœ‰ç‚¹åƒï¼ŒMaximum Likelihood çš„æƒ³æ³•å’ŒMinimize Loss çš„æƒ³æ³•æ˜¯ä¸€æ ·çš„ã€‚

Likelihood çš„æ„æ€æ˜¯ï¼šè®¡ç®—æ¦‚çŽ‡å¯†åº¦å‡½æ•° $f_{\theta}$ äº§ç”Ÿå¦‚å›¾æ‰€ç¤ºçš„æ‰€æœ‰æ•°æ®æ¦‚çŽ‡æœ‰å¤šå¤§ã€‚

è‹¥ä¸¥æ ¼è¯´çš„è¯ï¼Œ $f_{\theta}(x)$ è¾“å‡ºå¹¶ä¸æ˜¯æ¦‚çŽ‡ï¼Œå®ƒçš„è¾“å‡ºæ˜¯probability density ï¼›è¾“å‡ºçš„èŒƒå›´ä¹Ÿå¹¶ä¸æ˜¯(0,1)ï¼Œæœ‰å¯èƒ½å¤§äºŽ1ã€‚å¦‚æžœä½ æ¦‚çŽ‡è®ºå­¦çš„æ¯”è¾ƒå¥½ï¼Œé‚£ä½ åº”è¯¥èƒ½å¾ˆå¥½ç†è§£è¿™ä¸ªæ¦‚çŽ‡å¯†åº¦ï¼Œä¸è¡Œçš„è¯è¿™é‡Œæˆ‘ä»¬å°±ç®€å•çš„å°†å…¶ç†è§£æˆæ¦‚çŽ‡ã€‚ $x^i$ åœ¨ä»¥ $\theta$ ä¸ºå‚æ•°çš„probability density function sampleå‡ºæ¥çš„æ¦‚çŽ‡æ˜¯ $f_{\theta}(x^i)$ ï¼Œæ‰€ä»¥æ‰€æœ‰çš„æ ·æœ¬ä»Žè¿™ä¸ª $f_{\theta}(x)$ ä¸­sampleå‡ºæ¥çš„æ¦‚çŽ‡å°±æ˜¯å„ä¸ªæ ·æœ¬çš„æ¦‚çŽ‡è¿žä¹˜ã€‚

è¿žä¹˜å¾—åˆ°çš„ç»“æžœå°±æ˜¯likelihood å¦‚ä¸Šå›¾æ‰€ç¤º $L(\theta)$ ã€‚likelihood çš„å¯èƒ½æ€§æ˜¾ç„¶æ˜¯ç”± $\theta$ æŽ§åˆ¶çš„ï¼Œé€‰æ‹©ä¸åŒçš„ $\theta$ å°±æœ‰ä¸åŒçš„probability density functionï¼Œå°±å¯ä»¥ç®—æ³•ä¸åŒçš„likelihood ã€‚

è€Œæˆ‘ä»¬çŽ°åœ¨å¹¶ä¸çŸ¥é“è¿™ä¸ª Î¸ æ˜¯å¤šå°‘ï¼Œæˆ‘ä»¬è¦ç®—ä¸€ä¸ª $Î¸^*$ ç®—å‡ºæ¥çš„likelihoodæ˜¯æœ€å¤§çš„ã€‚

![image-20201108140407999](images/image-20201108140407999.png)

é‚£ä¸Šè¿°çš„æ¦‚çŽ‡å¯†åº¦å‡½æ•°é•¿ä»€ä¹ˆæ ·å­å‘¢ï¼Œæˆ‘ä»¬è¦ç¡®å®šè¿™ä¸ªæ¦‚çŽ‡å¯†åº¦å‡½æ•°çš„æž¶æž„ã€‚æˆ‘ä»¬å¯ä»¥å‡è®¾è¿™ä¸ªæ¦‚çŽ‡å¯†åº¦å‡½æ•°æ˜¯Gaussian Distribution ï¼ˆé«˜æ–¯åˆ†å¸ƒï¼‰ï¼Œé«˜æ–¯åˆ†å¸ƒçš„å‡½æ•°å¼å°±æ˜¯ä¸Šå›¾æœ€ä¸Šé¢çš„å…¬å¼ã€‚

åœ¨Gaussian Distribution çš„å‡½æ•°å¼ä¸­ï¼Œå‚æ•° $\theta$ åº”è¯¥æ˜¯ $\{mean:\mu, convariance matrix:\Sigma\}$ã€‚å‡è®¾å¦‚ä¸Šå›¾æ‰€ç¤ºçš„æ•°æ®æ˜¯ç”±å·¦ä¸Šè§’çš„ $\{\mu,\Sigma\}$ æ¥ç”Ÿæˆçš„ï¼Œæ•°æ®ç‚¹åº”è¯¥åœ¨å·¦ä¸Šè§’çš„è“è‰²åœˆåœˆä¸­sample å‡ºæ¥ï¼Œå®ƒçš„likelihood æ˜¯æ¯”è¾ƒå¤§ï¼›å¦‚æžœæ˜¯å³ä¸‹è§’ $\{\mu,\Sigma\}$ ï¼Œå®ƒè¿œç¦»é«˜å¯†åº¦åŒºåŸŸï¼Œè¿™ä¸ªå‡½æ•°sample å‡ºçš„æ•°æ®å› è¯¥å¤šæ•°åœ¨å³ä¸‹è§’è“è‰²åœˆåœˆä¸­ï¼Œä½†è¿™ä¸Žå®žé™…ä¸ç¬¦ï¼Œæ˜¾ç„¶è¿™æ ·è®¡ç®—å‡ºæ¥çš„likelihood æ˜¯æ¯”è¾ƒä½Žçš„ã€‚

psï¼šä¸è¦é—®ä¸ºä»€ä¹ˆç”¨é«˜æ–¯åˆ†å¸ƒï¼Œå¦‚æžœæˆ‘ç”¨å…¶ä»–çš„åˆ†å¸ƒä½ ä¹Ÿä¼šé—®åŒæ ·çš„é—®é¢˜ã€‚å†è€…å°±æ˜¯å› ä¸ºå®ƒè¯¥æ­»çš„å¥½ç”¨ï¼ŒçŽ°å®žä¸­å¾ˆå¤šæ•°æ®çš„åˆ†å¸ƒéƒ½æ¯”è¾ƒå¥½çš„ç¬¦åˆé«˜æ–¯åˆ†å¸ƒã€‚ä½ æ°¸è¿œå¯ä»¥æ ¹æ®ä½ çš„æ•°æ®é€‰æ‹©åˆé€‚çš„åˆ†å¸ƒæ¨¡åž‹ã€‚å¦å¤–è¿™é‡Œå†è€ƒè™‘ä¸€ä¸‹ï¼Œå¦‚æžœ $f_{\theta}(x)$ æ˜¯ä¸€ä¸ªå¾ˆå¤æ‚çš„ç½‘ç»œï¼Œ $\theta$ æ˜¯ç½‘ç»œä¸­çš„å¤§é‡å‚æ•°ï¼Œè¿™æ—¶å€™ä½ å°±ä¼šæœ‰æ›´å¤šçš„è‡ªç”±é€‰æ‹©ä¸€ä¸ªmodel æ¥æ¨¡æ‹Ÿç”Ÿæˆæ•°æ®ç‚¹ï¼Œè¿™æ ·å°±ä¸ä¼šè¢«é™åˆ¶ä½ï¼Œåœ¨çœ‹èµ·æ¥å°±ä¸åƒGaussian äº§ç”Ÿçš„æ•°æ®å´ç¡¬è¦è¯´æ˜¯Gaussian äº§ç”Ÿçš„æ•°æ®ã€‚å› ä¸ºæˆ‘ä»¬è¿™é—¨è¯¾è¿˜æ²¡æœ‰è®²åˆ°å…¶å®ƒè¿›é˜¶çš„æ¨¡åž‹ï¼Œæ‰€ä»¥çŽ°åœ¨ç”¨Gaussian Distribution æ¥å½“åšæˆ‘ä»¬èµ„æ–™æ˜¯ç”±Gaussian Distribution æ‰€äº§ç”Ÿçš„ã€‚

Guassian Distribution ä¸­çš„å‚æ•°æ˜¯å¾ˆå¥½è§£çš„ï¼Œ$\mu^*$ ç­‰äºŽæ‰€æœ‰training data åšå¹³å‡ï¼Œ $\Sigma^*$ ç­‰äºŽå°†xå‡åŽ» $\mu^*$ ä¹˜ä»¥ $x$ å‡åŽ» $\mu^*$ çš„è½¬ç½®ï¼Œç„¶åŽåšå¹³å‡ã€‚å¾—åˆ°çš„ç»“æžœå¦‚ä¸‹å›¾ï¼š

![image-20201108144145852](images/image-20201108144145852.png)

å¥½äº†ï¼ŒçŽ°åœ¨æˆ‘ä»¬æ ¹æ®training data æ‰¾å‡ºäº† $\{\mu^*,\Sigma^*\}$ ï¼ŒæŽ¥ä¸‹æ¥å°±å¯ä»¥åšå¼‚å¸¸æ£€æµ‹äº†ã€‚å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œå°† $\{\mu,\Sigma\}$ ä»£å…¥probability density function ï¼Œè‹¥å¤§äºŽæŸä¸€ä¸ªthreshold ï¼ˆé˜ˆå€¼ï¼‰å°±è¯´æ˜Žæ˜¯æ­£å¸¸çš„ï¼Œè‹¥å°äºŽè¿™ä¸ªthreshold å°±è¯´æ˜Žæ˜¯å¼‚å¸¸çš„ã€‚

![image-20201108144228801](images/image-20201108144228801.png)

æ¯ä¸€ç¬”èµ„æ–™éƒ½å¯ä»¥ä»£å…¥probability density function ç®—å‡ºä¸€ä¸ªæ•°å€¼ï¼Œç»“æžœå¦‚å›¾æ‰€ç¤ºã€‚è‹¥è½åœ¨é¢œè‰²æ·±çš„çº¢è‰²åŒºåŸŸï¼Œå°±è¯´æ˜Žç®—å‡ºæ¥çš„æ•°å€¼è¶Šå¤§ï¼Œè¶Šæ˜¯ä¸€èˆ¬çš„çŽ©å®¶ï¼Œé¢œè‰²æµ…çš„è“è‰²åŒºåŸŸï¼Œå°±è¯´æ˜Žè¿™ä¸ªçŽ©å®¶çš„è¡Œä¸ºè¶Šå¼‚å¸¸ã€‚å¦‚å›¾æ‰€ç¤ºçš„ä¸¤ä¸ªç‚¹ï¼šå³ä¸Šè§’çš„ä¸€ä¸ªçŽ©å®¶è½åœ¨å¾ˆå–œæ¬¢è¯´åžƒåœ¾è¯ï¼Œå¤šæ•°å–œæ¬¢åœ¨æ— æ”¿åºœçŠ¶æ€ä¸‹å‘è¨€çš„åŒºåŸŸï¼Œå°±è¯´æ˜Žæ˜¯ä¸€ä¸ªæ­£å¸¸çš„çŽ©å®¶ã€‚å·¦ä¸‹è§’çš„ä¸€ä¸ªçŽ©å®¶è½åœ¨å¾ˆå°‘è¯´åžƒåœ¾è¯ï¼Œç‰¹åˆ«å–œæ¬¢åœ¨æ°‘ä¸»æ—¶å‘è¨€ï¼Œå°±è¯´æ˜Žæ˜¯ä¸€ä¸ªå¼‚å¸¸çš„çŽ©å®¶ã€‚

åˆ°è¿™é‡Œæˆ‘ä»¬å¯¹Twitch Play PokÃ©mon çš„å¼‚å¸¸çŽ©å®¶æŽ¢æµ‹å°±ç»“æŸäº†ï¼Œæˆ‘ä»¬æ¥ç¨å¾®æ€»ç»“ä¸€ä¸‹ï¼Œæˆ‘ä»¬ç”¨äº†ä¸¤ç§ç‰¹å¾è¡¨ç¤ºçŽ©å®¶ï¼Œå‡å®šäº†çŽ©å®¶çš„åœ¨è¿™ä¸¤ä¸ªç‰¹å¾ç»´åº¦ä¸Šåˆ†å¸ƒç¬¦åˆGaussian Distribution ï¼Œç„¶åŽæ ¹æ®æ•°æ®å­¦é™¤äº†ä¸€ä¸ªæ¯”è¾ƒå¥½çš„fit è¿™äº›æ•°æ®çš„é«˜æ–¯åˆ†å¸ƒæ¨¡åž‹ï¼Œç„¶åŽç”¨é˜ˆå€¼åˆ†ç±»çš„æ–¹æ³•å®Œæˆäº†å¼‚å¸¸æ£€æµ‹ã€‚

ä¸Šè¿°æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬åªæ˜¯ç”¨äº†ä¸¤ä¸ªç‰¹å¾ï¼Œé‚£å¦‚æžœåŠ ä¸Šæ›´å¤šçš„ç‰¹å¾æˆ–è®¸æ•ˆæžœä¼šæ›´å¥½ï¼š

![image-20201108145118810](images/image-20201108145118810.png)

å†åŠ å…¥ä¸€äº›ç‰¹å¾ï¼Œæ¯”å¦‚å¦‚æžœæœ‰äººä¸åœæŒ‰start é”®ï¼Œé‚£å®ƒå¯èƒ½å°±æ˜¯ä¸€ä¸ªå¼‚å¸¸çŽ©å®¶ï¼Œè¿˜æœ‰å’Œå…¶ä»–äººä¸€ä¸ä¸€æ ·ï¼Œæ¯”è¾ƒä¸€æ ·çš„å¯èƒ½å°±ä¼šæ˜¯æ­£å¸¸çŽ©å®¶ï¼Œå†æœ‰ä¸åœå”±åè°ƒçš„äººå¯èƒ½ä¹Ÿæ˜¯å¼‚å¸¸çŽ©å®¶ã€‚åŠ ä¸Šè¿™äº›ç‰¹å¾ï¼Œå®žè·µä¸€ä¸‹å¾—åˆ°çš„ç»“æžœï¼š

![image-20201108145843183](images/image-20201108145843183.png)

è¿™é‡Œå–log çš„åŽŸå› æ˜¯åŽŸæœ¬çš„å‡½æ•°ç®—å‡ºæ¥çš„è¾“å‡ºå¤ªå°äº†ã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç¬¬ä¸€ä¸ªå’Œç¬¬ä¸‰ä¸ªçŽ©å®¶é™¤äº†ç¬¬å››ä¸ªç‰¹å¾éƒ½ä¸€æ ·ï¼Œä½†æ˜¯ç¬¬ä¸€ä¸ªçŽ©å®¶å’Œå¤§å®¶çš„é€‰æ‹©å®Œå…¨ä¸€æ ·ï¼Œç¬¬ä¸‰ä¸ªçŽ©å®¶å’Œå¤§å®¶çš„é€‰æ‹©åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹æ˜¯ç›¸åŒçš„ï¼Œè¿™æ˜¯ç¬¬ä¸€ä¸ªå¾—åˆ°çš„åˆ†æ•°åè€Œä½Žï¼Œæ˜¯å› ä¸ºæœºå™¨ä¼šè§‰å¾—å¦‚æžœä½ å’Œæ‰€æœ‰äººå®Œå…¨ä¸€æ ·è¿™ä»¶äº‹å°±æ˜¯å¾ˆå¼‚å¸¸çš„ã€‚



## Outlook: Auto-encoder

ä¸Šè¿°æ˜¯ç”¨Generative Model ï¼ˆç”Ÿæˆæ¨¡åž‹ï¼‰ æ¥è¿›è¡Œå¼‚å¸¸æ£€æµ‹ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨Auto-encoder æ¥åšè¿™ä¸ªä»»åŠ¡ã€‚

![image-20201108150302883](images/image-20201108150302883.png)

æˆ‘ä»¬æŠŠæ‰€æœ‰çš„è®­ç»ƒèµ„æ–™è®­ç»ƒä¸€ä¸ªEncoder ï¼ŒEncoder æ‰€åšçš„äº‹æƒ…æ˜¯å°†è¾“å…¥çš„å›¾ç‰‡ï¼ˆæ¯”å¦‚è¾›æ™®æ£®ï¼‰å˜ä¸ºcodeï¼ˆä¸€ä¸ªå‘é‡ï¼‰ï¼ŒDecoder æ‰€åšäº‹æƒ…æ˜¯å°†code è§£å›žåŽŸæ¥çš„å›¾ç‰‡ã€‚è®­ç»ƒæ—¶Encoder å’ŒDecoder æ˜¯åŒæ—¶è®­ç»ƒï¼Œè®­ç»ƒç›®æ ‡æ˜¯å¸Œæœ›è¾“å…¥å’Œè¾“å‡ºè¶ŠæŽ¥è¿‘è¶Šå¥½ã€‚

![image-20201108150541402](images/image-20201108150541402.png)

åœ¨æµ‹è¯•çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±æŠŠä¸€å¼ å›¾ç‰‡æ”¾å…¥è¿™ä¸ªAuto-Encoder modelï¼Œå¾—åˆ°ä¸€ä¸ªè¾“å‡ºå›¾ç‰‡ã€‚å› ä¸ºè¿™ä¸ªç½‘ç»œè®­ç»ƒæ—¶ä½¿ç”¨çš„æ˜¯è¾›æ™®æ£®å®¶åº­çš„å›¾ç‰‡ï¼Œæ‰€ä»¥å®ƒå¯¹è¾›æ™®æ£®å®¶åº­çš„å›¾ç‰‡çš„è¿˜åŽŸåº”è¯¥æ˜¯æ¯”è¾ƒå¥½çš„ï¼Œè€Œå¼‚å¸¸çš„å›¾ç‰‡çš„è¿˜åŽŸåº”è¯¥ä¼šæ˜¯æ¨¡ç³Šçš„ï¼ŒåŸºäºŽæ­¤æˆ‘ä»¬å¯ä»¥åšAuto-Encoder based Anomaly Detectionã€‚



## More ...

![image-20201108150727439](images/image-20201108150727439.png)

Machine Learning ä¸­ä¹Ÿæœ‰å…¶å®ƒåšå¼‚å¸¸æ£€æµ‹çš„æ–¹æ³•ï¼Œæ¯”å¦‚SVMçš„One-class SVM ï¼Œåªéœ€è¦æ­£å¸¸çš„èµ„æ–™å°±å¯ä»¥è®­ç»ƒSVM ï¼Œç„¶åŽå°±å¯ä»¥åŒºåˆ†æ­£å¸¸çš„è¿˜æ˜¯å¼‚å¸¸çš„æ•°æ®ã€‚åœ¨Random Forset çš„Isolated Forest ï¼Œå®ƒæ‰€åšçš„äº‹æƒ…è·ŸOne-class SVM æ‰€åšçš„äº‹æƒ…å¾ˆåƒï¼ˆç»™å‡ºæ­£å¸¸çš„è®­ç»ƒè¿›è¡Œè®­ç»ƒï¼Œæ¨¡åž‹ä¼šå‘Šè¯‰ä½ å¼‚å¸¸çš„èµ„æ–™æ˜¯ä»€ä¹ˆæ ·å­ï¼‰ã€‚

> One-class SVM Ref: https://papers.nips.cc/paper/1723-support-vector-method-for-novelty-detection.pdf
>
> Isolated Forest Ref: https://cs.nju.edu.cn/zhouzh/zhouzh.files/publication/icdm08b.pdf

