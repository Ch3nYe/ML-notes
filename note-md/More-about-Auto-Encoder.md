---
title: More about Auto-Encoder
date: 2020-12-11
tags:
	- ML
	- note
	- Next-Step-of-ML
categories:
  - æå®æ¯…æœºå™¨å­¦ä¹ ç¬”è®°
---

# More about Auto-Encoder

è¿™èŠ‚è¯¾è¦è®²çš„æ˜¯åœ¨ä»¥å‰çš„è¯¾ç¨‹ä¸Šæ²¡æœ‰è®²çš„ï¼Œ è¿‘å¹´æ¥çš„çƒ­é—¨çš„Auto-Encoder æŠ€æœ¯ã€‚



## Review

![image-20201210112818688](images/image-20201210112818688.png)

Auto-Encoder å°±æ˜¯æœ‰ä¸€ä¸ªEncoder çš„network ï¼Œæœ‰ä¸ªDecoder çš„network ï¼Œä¸­é—´ä¼šäº§å‡ºä¸€ä¸ªvector ï¼Œä½ å¯ä»¥å«å®ƒEmbeddingï¼ŒLatent Representationï¼ŒLatent Codeç­‰ã€‚Decoder ä¼šæ ¹æ®vector äº§å‡ºä¸€ä¸ªè¾“å‡ºï¼Œæˆ‘ä»¬å¸Œæœ›è¿™ä¸ªè¾“å‡ºå’ŒåŸå§‹çš„è¾“å…¥è¶Šæ¥è¿‘è¶Šå¥½ï¼Œä»¥æ­¤ä½œä¸ºloss æ›´æ–°æ¨¡å‹å‚æ•°ã€‚

ä»Šå¤©è¦è®²çš„å†…å®¹åˆ†ä¸¤ä¸ªéƒ¨åˆ†ï¼š

- ä¸ºä»€ä¹ˆä¸€å®šè¦Minimize reconstruction error ï¼Œæœ‰æ²¡æœ‰å…¶ä»–çš„åšæ³•å‘¢
- æ€ä¹ˆè®©Encoder è¾“å‡ºçš„vector æ›´å®¹æ˜“è¢«è§£è¯»



æ¥ä¸‹æ¥æˆ‘ä»¬è¦å…ˆè®²ç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œè¿™é‡Œæ˜¯é€šè¿‡å¼•å…¥Discriminator ï¼Œæ¥æ›¿ä»£minimize Reconstruction Error ã€‚è¯¦æƒ…ä¸”çœ‹ä¸‹é¢çš„æè¿°ã€‚

## What is good embedding?

æˆ‘ä»¬å›æƒ³ä¸€ä¸‹ä¸ºä»€ä¹ˆè¦åšembedding å‘¢ï¼Œæˆ‘ä»¬æ˜¯å¸Œæœ›é€šè¿‡è¿™ä¸ªembedding æ¥ä»£è¡¨åŸæ¥çš„è¾“å…¥ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œæˆ‘ä»¬çœ‹åˆ°è€³æœºå°±èƒ½æƒ³åˆ°ä¸‰ç–ï¼Œè€Œä¸ä¼šæƒ³åˆ°ä¸€èŠ±ã€‚ğŸ¤£

![image-20201210113946970](images/image-20201210113946970.png)



## **Beyond Reconstruction** 

Encoder åƒè¿›ä¸€ä¸ªè¾“å…¥ï¼Œå°±äº§ç”Ÿä¸€ä¸ªå¯¹åº”çš„ä»£è¡¨è¯¥è¾“å…¥çš„embeddingï¼š

![image-20201210114322581](images/image-20201210114322581.png)

é‚£æˆ‘ä»¬æ€ä¹ˆçŸ¥é“è¿™ä¸ªäº§ç”Ÿçš„embedding çš„ä»£è¡¨æ€§å¥½ä¸å¥½å‘¢ï¼Œæˆ‘ä»¬è®­ä¸€ä¸ªDiscriminator ï¼Œinput æ˜¯ä¸€ä¸ªå¼ å›¾ç‰‡å’Œembedding ï¼Œoutput å°±æ˜¯è¿™ä¸€å¯¹è¾“å…¥æ˜¯ä¸æ˜¯å¯¹åº”çš„ï¼Œä½ å¯ä»¥æƒ³è±¡è¿™æ˜¯ä¸€ä¸ªäºŒåˆ†ç±»å™¨ã€‚å¦‚ä¸Šå›¾å·¦ä¸Šæ–¹æ‰€ç¤ºã€‚

è¿™ä¸ªDiscriminator çš„è®­ç»ƒèµ„æ–™å°±æ˜¯å¾ˆå¤šï¼ˆå›¾ç‰‡+embeddingï¼‰çš„äºŒå…ƒç»„ï¼Œè¿™äº›äºŒå…ƒç»„æœ‰çš„æ˜¯å¯¹åº”çš„æœ‰çš„æ˜¯æ•…æ„ç”¨ä¸å¯¹åº”çš„ç»„åˆï¼Œå¹¶ä¸”æ‰“ä¸Šæ ‡ç­¾ã€‚å¦‚ä¸Šå›¾å³ä¸‹è§’æ‰€ç¤ºã€‚

ç„¶åå°±è¦å®šä¸€ä¸ªloss function $L_D$ï¼Œå¯¹äºè¿™ä¸ªDiscriminator æœ€ç®€å•çš„å°±æ˜¯ç”¨Binary cross entropy ï¼Œæ²¡ä»€ä¹ˆå¥½è¯´çš„ã€‚

æ¥ä¸‹æ¥å°±æ˜¯è®­ç»ƒè¿™ä¸ªDiscriminator å»minimize loss function ï¼Œå»æ‰¾ä¸€ç»„æœ€å¥½çš„Discriminator çš„å‚æ•° $\phi$ ã€‚æ‰¾åˆ°çš„æœ€å¥½çš„ $\phi$ è¾¾åˆ°çš„æœ€ä½çš„loss æˆ‘ä»¬æŠŠæ­¤æ—¶çš„æŸå¤±å‡½æ•°å€¼å«åš ${L_D}^*$ ã€‚

å¦‚æœè¯´è¿™ä¸ª ${L_D}^*$ å¾ˆå°ï¼Œé‚£æ„å‘³ç€ç°åœ¨è¿™ä¸ªEncoder æ˜¯å¾ˆå¥½çš„ï¼ŒDiscriminator å¾ˆå®¹æ˜“å°±èƒ½çŸ¥é“embedding ä¹‹é—´æ˜¯ä¸åŒçš„ï¼Œå¯ä»¥è½»æ˜“çš„åˆ†è¾¨å‡ºå„ä¸ªembedding åº”è¯¥å¯¹åº”çš„åŸå§‹è¾“å…¥ï¼›å¦‚æœè¯´è¿™ä¸ª ${L_D}^*$ å¾ˆå¤§ï¼Œé‚£å°±æ„å‘³ç€ç°åœ¨è¿™ä¸ªEncoder å°±æ˜¯æ¯”è¾ƒå·®çš„ï¼Œè¿™ä¸ªEncoder å¾—åˆ°çš„embedding éƒ½æ¯”è¾ƒç›¸ä¼¼ï¼ŒDiscriminator éš¾ä»¥åˆ†è¾¨è¿™äº›embedding ä¹‹é—´çš„åŒºåˆ«ã€‚

å¦‚æœå½¢è±¡ç‚¹ç”¨é¢œè‰²æ¥è¯´ï¼Œå¥½çš„Encoder å¾—åˆ°çš„embedding åº”è¯¥ä¼šæ˜¯å¦‚ä¸Šå›¾é¢œè‰²å„å¼‚çš„ï¼Œè€Œå·®çš„Encoder å¾—åˆ°çš„embedding å¯èƒ½å°±æ˜¯ä¸‹é¢è¿™æ ·é¢œè‰²ç›¸è¿‘çš„ï¼š

![image-20201210120313813](images/image-20201210120313813.png)

æ¥ä¸‹æ¥æˆ‘ä»¬è¦åšçš„äº‹ï¼Œå°±æ˜¯æ ¹æ® ${L_D}^*$ è°ƒæ•´Encoder çš„å‚æ•° $\theta$ ï¼Œä½¿å¾—Encoder å¾—åˆ°çš„embedding åœ¨é€šè¿‡Discriminator æ—¶å€™èƒ½è¢«å¾ˆå¥½çš„åˆ†è¾¨ï¼Œå¾—åˆ°è¾ƒä½çš„ ${L_D}^*$ ã€‚

![image-20201210120556079](images/image-20201210120556079.png)

ä¸Šè¿°çš„è¿™ä¸ªæ–¹æ³•ï¼Œè¢«ç”¨åœ¨Deep InfoMax(DIM) è¿™ç¯‡paper ä¸­ã€‚è¿™ä¸ªDiscriminator å¯ä»¥åšä¸åŒçš„è®¾è®¡ï¼Œæ¯”å¦‚ç”¨ä¸åŒçš„loss è®¡ç®—æ–¹æ³•ç­‰ï¼Œç»“æœä¼šä¸å¤ªä¸€æ ·ã€‚

åœ¨è®­ç»ƒçš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¸€èµ·train Encoder å’ŒDiscriminator ï¼Œè¿™ä»¶äº‹å°±å¥½åƒæˆ‘ä»¬åœ¨train ä¸€èˆ¬çš„Auto-Encoder æ—¶ï¼Œä¸€èµ·train Encoder å’ŒDecoder å»minimize Reconstruction Error ä¸€æ ·ã€‚

è¿™å°±æ˜¯å¼•å…¥Discriminator ï¼Œæ¥æ›¿ä»£minimize Reconstruction Error çš„åšæ³•ã€‚



## Typical auto-encoder is a special case

ç»å…¸çš„auto-encoder å¯ä»¥çœ‹ä½œä¸Šè¿°çš„æ–¹æ³•çš„ä¸€ä¸ªç‰¹ä¾‹ã€‚æ€ä¹ˆè¯´å‘¢

![image-20201210121556480](images/image-20201210121556480.png)

ä½ å¯ä»¥æŠŠDiscriminator çœ‹ä½œå®ƒæ ¹æ®vector åšäº†ä¸€ä¸ªDecoder åšçš„äº‹æƒ…ï¼Œç„¶åæŠŠè¾“å‡ºå’ŒåŸå§‹è¾“å…¥ç®—ä¸€ä¸ªReconstruction Error åˆ†æ•°ã€‚



## Sequential Data

å¦‚æœä½ çš„æ•°æ®æ˜¯åºåˆ—æ€§çš„ï¼Œæ¯”å¦‚è¯´æ–‡ç« ï¼Œè¿™æ—¶ä½ å°±å¯ä»¥åšæ›´å¤šçš„å˜åŒ–ã€‚

![image-20201210122806382](images/image-20201210122806382.png)

### Skip thought

> https://papers.nips.cc/paper/5950-skip-thought-vectors.pdf

å¦‚ä¸Šå›¾æ‰€ç¤ºï¼ŒSkip thought å°±æ˜¯æ ¹æ®å½“å‰è¾“å…¥çš„çš„å¥å­é¢„æµ‹ä¸Šä¸‹æ–‡ã€‚è¿™ä»¶äº‹å’Œè®­ WordEmbedding æ˜¯å¾ˆåƒçš„ï¼ŒWordEmbedding æ˜¯è¯´æŠŠæ–‡ç« ä¸­å‡ºç°åœ¨åŒæ ·æˆ–è€…ç›¸ä¼¼ä¸Šä¸‹æ–‡çš„å•è¯è¯­ä¹‰åº”è¯¥æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥ç”¨ç›¸åŒæˆ–è€…ç›¸ä¼¼çš„Embedding æ¥è¡¨ç¤ºã€‚Skip thought çš„æ€æƒ³ä¹Ÿæ˜¯è¿™æ ·ï¼Œåªæ˜¯æ‰©å±•åˆ°å¥å­ï¼Œå¦‚æœä¸¤ä¸ªå¥å­çš„ä¸Šä¸‹æ–‡æ˜¯ç›¸åŒæˆ–è€…ç›¸ä¼¼çš„ï¼Œé‚£è¿™ä¸¤ä¸ªå¥å­åº”è¯¥æ˜¯è¯­ä¹‰ç›¸è¿‘çš„ã€‚æ¯”å¦‚è¯´ï¼ŒAæé—®è¿™ä¸ªä¸œè¥¿æœ‰å¤šè´µï¼ŒBå›ç­”10å—ï¼ŒAæé—®è¿™ä¸ªä¸œè¥¿è¦å¤šå°‘é’±ï¼ŒBå›ç­”10å—ã€‚Skip thought å°±ä¼šçŸ¥é“æœ‰å¤šè´µå’Œè¦å¤šå°‘é’±çš„è¯­ä¹‰æ˜¯ç›¸ä¼¼çš„ã€‚

Skip thought ä¸ä»…è¦è®­ç»ƒEncoderï¼ˆåšembeddingï¼‰ è¿˜è¦è®­ç»ƒDecoder ï¼ˆåšé¢„æµ‹ä¸Šä¸‹æ–‡ï¼‰ï¼Œè®©æœºå™¨äº§ç”Ÿé¢„æµ‹ç»“æœï¼Œè¿™æ˜¯æ¯”è¾ƒè€—æ—¶çš„ã€‚



### Quick thought

> https://arxiv.org/pdf/1803.02893.pdf

è¿™æ˜¯Skip thought çš„å‡çº§ç‰ˆï¼Œé€Ÿåº¦æ¯”è¾ƒå¿«ã€‚æˆ‘å°±åªlearn encoder ä¸å»learn decode äº†ã€‚

æˆ‘ä»¬ç°åœ¨æŠŠæ¯ä¸ªå¥å­éƒ½åŒè¿‡encoder å¾—åˆ°å„è‡ªçš„embedding ï¼Œæ¯ä¸ªå¥å­è¦è·Ÿå®ƒçš„ä¸‹ä¸ªå¥å­çš„embedding è¶Šè¿‘è¶Šå¥½ã€‚å¦‚æœæ˜¯å…¶ä»–çš„å¥å­ï¼Œé‚£å®ƒä»¬çš„embedding å°±è¦å’Œå½“å‰å¥å­çš„embedding è¶Šè¿œè¶Šå¥½ã€‚

çœŸæ­£å®ä½œçš„æ—¶å€™å°±æ˜¯ï¼Œæœ‰ä¸ªclassifier å®ƒåƒå½“å‰å¥å­embedding ã€ä¸‹ä¸ªå¥å­embedding å’Œä¸€äº›éšæœºsample çš„å¥å­çš„embedding ï¼Œç„¶åç»™å‡ºå“ªä¸ªå¥å­æ˜¯å½“å‰å¥å­çš„ä¸‹ä¸€å¥ã€‚å¦‚ä¸Šå›¾æ‰€ç¤ºã€‚

classifer å’Œencoder æ˜¯å…±åŒè®­ç»ƒçš„ã€‚æ–‡ç« ä¸­çš„classifier æ˜¯å¾ˆç®€å•çš„ï¼Œå®ƒå°±æ˜¯ç®—å½“å‰å¥å­embedding å’Œå…¶ä»–å¥å­embedding ä¹‹é—´çš„å†…ç§¯ï¼Œå†…ç§¯è¶Šå¤§å°±è¶Šç›¸ä¿¡è¿™ä¸ªå¥å­æ˜¯å½“å‰å¥å­çš„ä¸‹ä¸€ä¸ªã€‚



### Contrastive Predictive Coding (CPC)

![image-20201210124600407](images/image-20201210124600407.png)

> https://arxiv.org/pdf/1807.03748.pdf

çœ‹å›¾å°±å¤§æ¦‚èƒ½æ˜ç™½å®ƒåœ¨åšä»€ä¹ˆï¼Œè¾“å…¥æ˜¯ä¸€æ®µå£°éŸ³ï¼Œè¿™æ®µå£°éŸ³åˆ†æˆå°æ®µï¼Œé€šè¿‡encoder å¾—åˆ°å¯¹åº”çš„embedding ï¼Œå¸Œæœ›å¾—åˆ°çš„embedding èƒ½å»é¢„æµ‹æ¥ä¸‹æ¥çš„åŒä¸€ä¸ªencoder ä¼šoutput çš„embedding ã€‚å°±å’Œä¸Šé¢Quick thought çš„æ¦‚å¿µæœ‰ç‚¹åƒã€‚



## More interpretable embedding

æ¥ä¸‹æ¥æˆ‘ä»¬è¿›å…¥ä¸‹ä¸€ä¸ªä¸»é¢˜ï¼Œæ€ä¹ˆè®©embedding æ›´å…·è§£é‡Šæ€§ã€‚

![image-20201210154838644](images/image-20201210154838644.png)



### Feature Disentangle 

Disentangle è¿™ä¸ªè¯çš„ä¸­æ–‡æ„æ€æ˜¯"è§£å¼€"ï¼Œå¤§æ¦‚å°±æ˜¯ä¸‹å›¾ä¸­ä¸€å›¢ä¸œè¥¿ç¼ åœ¨ä¸€èµ·æƒ³è¦è§£å¼€çš„é‚£ä¸ªè§£å¼€çš„æ„æ€ã€‚

![image-20201210155841879](images/image-20201210155841879.png)

æˆ‘ä»¬encoding çš„å¯¹è±¡åŒ…å«å„å¼å„æ ·çš„ä¿¡æ¯ï¼Œæ¯”å¦‚è¯´ä¸€æ®µå£°éŸ³ä¿¡å·ï¼ŒåŒ…å«è¯­è€…çš„è¯­ä¹‰ã€è¯­è€…çš„è¯­è°ƒã€ç¯å¢ƒå™ªéŸ³ç­‰ç­‰çš„ä¿¡æ¯ï¼Œæ–‡å­—ä¹Ÿæ˜¯ä¸€æ ·ï¼Œæœ‰è¯­ä¹‰çš„ä¿¡æ¯ã€æ–‡æ³•çš„ä¿¡æ¯ç­‰ï¼Œå›¾ç‰‡ä¹Ÿæ˜¯ï¼Œå†…å®¹çš„ä¿¡æ¯ã€å›¾ç‰‡é£æ ¼çš„ä¿¡æ¯ç­‰ã€‚

ä»¥è¯­éŸ³ä¿¡æ¯ä¸ºä¾‹ï¼Œencoder å¾—åˆ°çš„embedding å¯èƒ½åŒ…æ‹¬è¯­è€…çš„è¯­ä¹‰ä¿¡æ¯ã€è¯­è°ƒä¿¡æ¯ã€ç¯å¢ƒå™ªå£°ç­‰å¾ˆå¤šä¿¡æ¯ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸çŸ¥é“è¿™ä¸ªå‘é‡ä¸­é‚£äº›ç»´åº¦å¯¹åº”é‚£äº›ä¿¡æ¯ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬å¸Œæœ›decoder å¯ä»¥å‘Šè¯‰æˆ‘ä»¬é‚£äº›ç»´åº¦æ˜¯è¯­ä¹‰ä¿¡æ¯ã€å“ªäº›ç»´åº¦æ˜¯è¯­è€…çš„ä¿¡æ¯ç­‰ç­‰ã€‚

![image-20201210160407780](images/image-20201210160407780.png)

è¿™ä¸ªæƒ³æ³•ï¼Œå¯ä»¥é€šè¿‡ä¸¤ä¸ªæ€è·¯æ¥åšã€‚ç¬¬ä¸€ç§ï¼Œå¦‚ä¸Šå›¾ä¸ŠåŠéƒ¨åˆ†æ‰€ç¤ºï¼Œæˆ‘ä»¬å¸Œæœ›encoder è¾“å‡ºçš„embedding æœ‰ä¸€éƒ¨åˆ†ä»£è¡¨è¯­éŸ³ä¿¡æ¯ï¼Œä¸€éƒ¨åˆ†ä»£è¡¨è¯­è€…ä¿¡æ¯ã€‚ç¬¬äºŒç§ï¼Œåšä¸ªå˜å½¢å¦‚ä¸Šå›¾ä¸‹åŠéƒ¨åˆ†æ‰€ç¤ºï¼Œæˆ‘ä»¬æä¸¤ä¸ªencoder ä¸€ä¸ªæå–å‡ºè¯­ä¹‰ä¿¡æ¯çš„embedding ä¸€ä¸ªæå–å‡ºè¯­è€…ä¿¡æ¯çš„embedding ï¼ŒæŠŠä¸¤ä¸ªembedding æ‹¼åœ¨ä¸€èµ·æ”¾å…¥Decoder æ‰èƒ½è¿˜åŸè¾“å…¥ã€‚

è¿™é‡Œæ˜¯åšäº†ç®€åŒ–ï¼Œå‡è®¾åªæœ‰ä¸¤ä¸ªä¿¡æ¯ï¼Œå®é™…ä¸Šæœ‰æ›´å¤šçš„ã€‚

é‚£è¿™æ ·çš„è¯èƒ½åšåˆ°çš„ä»€ä¹ˆå‘¢ï¼Ÿ

### Feature Disentangle-Voice Conversion 

ä¸€çœ‹å°±çŸ¥é“æè€å¸ˆä¹Ÿæ˜¯è€å˜å£°å™¨äº†ã€‚ğŸ¤£

![image-20201210161246132](images/image-20201210161246132.png)

ä¸Šå›¾å¾ˆå¥½ç†è§£äº†ï¼Œæˆ‘ä»¬å¦‚ä¸Šå›¾æ‰€ç¤ºåšè®­ç»ƒï¼Œæˆ‘ä»¬ç”¨è¯­éŸ³ä¿¡æ¯è®­ç»ƒè¿™ä¸ªauto-encoder æ¨¡å‹ï¼Œè®©encoder output çš„embedding å¯ä»¥æŠŠè¯­è€…å’Œè¯­ä¹‰ä¿¡æ¯åˆ†å¼€æ¥ã€‚ç„¶åï¼š

![image-20201210161745063](images/image-20201210161745063.png)

æˆ‘ä»¬åšå¦‚ä¸Šå›¾æ‰€ç¤ºçš„embedding æ‹¼æ¥ï¼Œä¸¢ç»™decoder å®ƒå°±èƒ½è¾“å‡ºç”·ç”Ÿè¯´"How are you?"çš„éŸ³é¢‘ã€‚ğŸ˜®

ä½ å¯èƒ½ä¼šè¯´è¿™æœ‰ä»€ä¹ˆç”¨ï¼Ÿè¿™å½“ç„¶æœ‰ç”¨ï¼Œæ¯”å¦‚ç”¨æ–°å£ç»“è¡£çš„å£°éŸ³åŠä½ è¯»åšå£«ï¼Œä½ å¯èƒ½å°±ä¼šæ»¡å£ç­”åº”ä¸‹æ¥ã€‚ğŸ¤£

![image-20201210162000658](images/image-20201210162000658.png)

é‚£è¦æ€ä¹ˆåšæ‰èƒ½è®©encoder æŠŠä¸åŒçš„ä¿¡æ¯åˆ†å¼€åˆ°ä¸åŒçš„ç»´åº¦ä¸Šå‘¢ï¼Ÿä¸‹é¢ä»‹ç»å‡ ç§åšæ³•ã€‚



### Feature Disentangle-Adversarial Training 

ç”¨GANçš„æ€æƒ³

![image-20201210194924926](images/image-20201210194924926.png)

å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œåšæ³•æ˜¯è¿™æ ·çš„ï¼Œæˆ‘ä»¬è®­ç»ƒä¸€ä¸ªè¯­è€…è¾¨è¯†çš„classifier ï¼ŒEncoder æƒ³åŠæ³•å»éª—è¿‡speaker classifier ã€‚æ¯”å¦‚è¯´æŠŠembedding çš„å‰100ç»´ç»™speaker classifier åšè¾¨è¯†ï¼Œå½“Encoder å°è¯•éª—è¿‡speaker classifier çš„æ—¶å€™ï¼ŒEncoder å°±å¯èƒ½ä¼šæŠŠæœ‰å…³è¯­è€…çš„ä¿¡æ¯è—åœ¨embedding åé¢çš„ç»´åº¦ä¸­ã€‚ä»¥æ­¤ï¼Œæ¥åšåˆ°æŠŠè¯­è€…å’Œè¯­ä¹‰ä¿¡æ¯åˆ†å¼€åˆ°ä¸åŒçš„ç»´åº¦ä¸Šã€‚

æ‰€ä»¥ï¼Œä»GANçš„è§’åº¦æ¥è¯´ï¼Œspeaker classifier å°±æ˜¯Discriminator ï¼ŒEncoder å°±æ˜¯Generatorï¼Œspeaker classifier å’ŒEncoder æ˜¯è¿­ä»£trainçš„ï¼Œå°±æ˜¯ä½ å…ˆtrain speaker classifier å†train Encoder ï¼Œå¦‚æ­¤äº¤æ›¿å¾€å¤ã€‚



### Feature Disentangle-Designed Network Architecture

![image-20201210201419636](images/image-20201210201419636.png)

æˆ‘ä»¬è¿˜å¯ä»¥ç›´æ¥ä¿®æ”¹Encoder çš„æ¶æ„ï¼Œå¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œç›´æ¥è®©ä¸åŒçš„Encoder è¾“å‡ºå¯¹åº”çš„ä¿¡æ¯ï¼Œæ»¤æ‰ä¸éœ€è¦çš„ä¿¡æ¯ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œæœ‰ä¸€ç§ç¥ç»ç½‘ç»œçš„layer å«instance normalization ï¼Œè¿™ç§layer æˆ‘ä»¬å°±ä¸å±•å¼€è®²äº†ï¼Œå®ƒèƒ½åšåˆ°çš„å°±æ˜¯ç§»é™¤global information ï¼Œglobal information å°±æ˜¯æ‰€æœ‰æ ·æœ¬éƒ½å…·æœ‰çš„ä¿¡æ¯ã€‚é‚£å½“æˆ‘ä»¬æŠŠåŒä¸€ä¸ªäººè¯´çš„è¯éƒ½è¾“å…¥ç½‘ç»œï¼Œç½‘ç»œç§instance normalization layer å°±å¯èƒ½ä¼šæ»¤æ‰è¯­è€…ä¿¡æ¯ã€‚

ä½†æ˜¯è¿™æ ·æ˜¯ä¸å¤Ÿçš„ï¼Œè¿™æ ·å°±ç®—æˆ‘ä»¬ä¿è¯äº†Encoder1 åªåŒ…å«äº†è¯­ä¹‰ä¿¡æ¯ï¼Œæˆ‘ä»¬ä¹Ÿä¸èƒ½ä¿è¯Encoder2 åªåŒ…å«è¯­è€…ä¿¡æ¯ã€‚æ‰€ä»¥æˆ‘ä»¬è¦åœ¨Decoder ä¸ŠåŠ ä¸€ä¸ªadaptive instance normalization layer ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![image-20201210202421151](images/image-20201210202421151.png)

Encoder1 çš„embedding ç›´æ¥input ç»™Deocder ï¼ŒEncoder2 çš„embedding input åˆ°AdaIN è¿™ä¸ªlayer ï¼ŒAdaIN ä¼šè°ƒæ•´è¾“å‡ºçš„global çš„information ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœEncoder2 åœ¨å…¶è¾“å‡ºçš„embedding ä¸­æ”¾äº†è¯­ä¹‰ä¿¡æ¯ï¼Œè¿™ä¸ªembedding å°±ä¼šå¾ˆå¤§ç¨‹åº¦ä¸Šæ”¹å˜Deocder çš„è¾“å‡ºã€‚ç”¨è¿™ç§æ–¹æ³•ï¼Œä½¿Encoder2 è¾“å‡ºçš„embedding å°½é‡ä¸åŒ…å«è¯­ä¹‰ä¿¡æ¯ã€‚ 

ç”¨è¿™ç§æ”¹å˜Encoder æ¶æ„çš„æ–¹æ³•æ¥å®ç°ï¼Œå°†ä¸åŒä¿¡æ¯åˆ†ç¦»åˆ°ä¸åŒç»´åº¦ä¸Šã€‚



è¿™é‡Œè€å¸ˆæ¼”ç¤ºäº†ä»–çš„å­¦ç”ŸJu-chieh Chou ç”¨Adversarial Training å¾—åˆ°çš„ç»“æœï¼Œå¯ä»¥å‚è€ƒï¼š

> https://jjery2243542.github.io/voice_conversion_demo/





## Discrete Representation

æ¥ä¸‹æ¥æˆ‘ä»¬è¦è®²çš„æ˜¯ï¼Œè¿‡å»æˆ‘ä»¬åœ¨è®­Auto-Encoder çš„æ—¶å€™å¾—åˆ°çš„å‘é‡éƒ½æ˜¯è¿ç»­å€¼ï¼Œè¿™ä¸ªå‘é‡å…·ä½“è¡¨ç¤ºä»€ä¹ˆï¼Œä½ å¯èƒ½è‡ªå·±ä¹Ÿä¸æ˜¯å¾ˆæ¸…æ¥šã€‚ç°åœ¨æˆ‘ä»¬è€ƒè™‘Encoder èƒ½ä¸èƒ½è¾“å‡ºç¦»æ•£çš„embedding ï¼Œè¿™æ ·æˆ‘ä»¬å°±æ›´å®¹æ˜“è§£è¯»è¿™ä¸ªembedding çš„å«ä¹‰ï¼Œä¹Ÿæ›´å®¹æ˜“åšåˆ†ç¾¤ï¼Œæ¯”å¦‚è¯´Encoder è¾“å‡ºæ˜¯1çš„å›¾ç‰‡æ˜¯ä¸€ç±»ï¼Œè¾“å‡ºæ˜¯2çš„å›¾ç‰‡æ˜¯ä¸€ç±»ã€‚æ‰€ä»¥ï¼ŒEncoder å¦‚æœèƒ½è¾“å‡ºDiscrete çš„embedding ï¼Œé‚£è§£è¯»èµ·æ¥ä¼šæ›´å®¹æ˜“ã€‚

![image-20201211115801104](images/image-20201211115801104.png)

> https://arxiv.org/pdf/1611.01144.pdf

ä¸¾ä¾‹æ¥è¯´ï¼Œæˆ‘ä»¬å°±è®©embedding æ˜¯One-hot embeddingï¼Œå¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬å°±åœ¨Encoder è¾“å‡ºembedding åé¢åŠ ç‚¹ä¸œè¥¿ï¼Œå®ƒåšåˆ°çš„äº‹æƒ…å°±æ˜¯æŠŠæ•´ä¸ªembedding ä¸­æœ€å¤§çš„ä¸€ç»´è®¾ä¸º1ï¼Œå…¶ä»–éƒ½æ˜¯è®¾0å°±å¥½äº†ã€‚

å¦‚æœä½ ä¸æƒ³è¦one-hot vector ï¼Œé‚£ä¹Ÿå¯ä»¥è®©embedding è½¬ä¸ºbinary vector ï¼Œå¦‚ä¸Šå›¾ä¸‹åŠéƒ¨åˆ†æ‰€ç¤ºï¼ŒæŸä¸ªç»´åº¦çš„å€¼å¤§äº0.5å°±è®¾1ï¼Œå¦åˆ™å°±è®¾0ã€‚

ä½ å¯èƒ½ä¼šè¯´é‚£è¿™ä¸ªä¸œè¥¿æ²¡æ³•å¾®åˆ†å•Šï¼Œä½†æ˜¯å®é™…ä¸Šè¿˜æ˜¯æœ‰ä¸€äº›æŠ€å·§å¯ä»¥åšçš„ï¼Œè¿™é‡Œå°±ä¸å±•å¼€äº†ï¼Œå¯ä»¥è‡ªè¡ŒæŸ¥é˜…è®ºæ–‡ã€‚



### Vector Quantized Variational Auto-encoder (VQVAE)

ä¸Šè¿°çš„åšæ³•åœ¨æ–‡çŒ®ä¸Šæœ‰ä¸ªéå¸¸çŸ¥åçš„åšæ³•å«åšVQVAE

![image-20201211120347473](images/image-20201211120347473.png)

>https://arxiv.org/abs/1711.00937
>
>https://arxiv.org/pdf/1901.08810.pdf

VQVAE çš„åšæ³•æ˜¯è¿™æ ·çš„ï¼Œæœ‰ä¸€ä¸ªCodebook å…¶ä¸­åŒ…å«å¤šä¸ªvectorï¼Œè¿™é‡Œå‡è®¾åªæœ‰5ä¸ªå¥½äº†ï¼Œè¿™äº›vector æ˜¯ä»æ•°æ®ä¸­å­¦å‡ºæ¥çš„ã€‚è¾“å…¥ä¸€å¼ å›¾ç‰‡ç»™Encoder è¾“å‡ºä¸€ä¸ªæ•°å€¼ä¸Šæ˜¯è¿ç»­çš„embedding ï¼Œé‚£è¿™ä¸ªembedding å’ŒCodebook ä¸­çš„vector ç®—ç›¸ä¼¼åº¦ï¼Œå–ç›¸ä¼¼åº¦æœ€é«˜çš„ä½œä¸ºEncoder çš„è¾“å…¥ï¼Œç„¶åå–minimize reconstruction errorï¼Œç»“æŸã€‚

ä½ ä¼šè¯´ï¼Œä½ ç®—å®Œç›¸ä¼¼åº¦ç„¶åå–æœ€ç›¸ä¼¼çš„vector è¿™ä¸ªæ­¥éª¤ç›¸å½“äºæ˜¯åœ¨åšDiscreteï¼Œä½†æ˜¯è¿™ä¸æ˜¯æ²¡æ³•å¾®åˆ†å—ï¼Œå®é™…ä¸Šæ˜¯å¯ä»¥åšçš„ï¼Œæœ‰ä¸€äº›æŠ€å·§ï¼Œä¸å±•å¼€äº†ï¼Œè‡ªè¡Œè¯»æ–‡çŒ®å§ã€‚

è¿˜æœ‰ä¸€ä¸ªé‡è¦çš„äº‹æƒ…æ˜¯ï¼Œå¦‚æœä½ ç”¨VQVAE æˆ–è€…å…¶ä»–çš„Discrete embeddingçš„æ–¹æ³•ï¼Œé‚£ä½ å°±èƒ½åšåˆ°è®©Deocder å¾—åˆ°çš„Discrete embedding åªåŒ…å«è¯­ä¹‰ä¿¡æ¯è€Œä¸åŒ…å«è¯­è€…ä¿¡æ¯å’Œç¯å¢ƒå™ªå£°ç­‰ï¼Œä¹Ÿå°±æ˜¯è¯´åªæœ‰æœ‰å…³æ–‡å­—çš„ä¿¡æ¯æ‰ä¼šè¢«å­˜ä¸‹æ¥ã€‚åŸå› æ˜¯è¿™æ ·çš„ï¼Œä½ æƒ³æƒ³çœ‹è¿™äº›Discrete embedding å°±æ˜¯å®¹æ˜“å­˜Discrete çš„ä¿¡æ¯ï¼Œè€Œå£°éŸ³ä¿¡æ¯ã€ç¯å¢ƒå™ªå£°éƒ½æ˜¯è¿ç»­çš„ï¼Œä½†æ–‡å­—ä¿¡æ¯æ˜¯ä¸€ä¸ªä¸€ä¸ªçš„tokenï¼Œæ˜¯ç¦»æ•£çš„ï¼Œæ‰€ä»¥è¯´æ–‡å­—ä¿¡æ¯è¢«ä¿ç•™ä¸‹æ¥ï¼Œå…¶ä»–ä¿¡æ¯è¢«æ»¤æ‰äº†ã€‚



### Sequence as Embedding

æˆ‘ä»¬ä¸Šé¢è¯´è®©embedding å˜æˆç¦»æ•£çš„ä¼šæ›´å®¹è§£è¯»ï¼Œé‚£æˆ‘ä»¬ç”šè‡³å¯ä»¥è®©ä¸­é—´è¡¨ç¤ºä¸å†æ˜¯ä¸€ä¸ªå‘é‡ï¼Œè®©å®ƒç”¨word sequence è¡¨ç¤ºï¼š

![image-20201211122057281](images/image-20201211122057281.png)

> https://arxiv.org/abs/1810.02851

å‡å¦‚è¯´æˆ‘ä»¬çš„Encoder çš„è¾“å…¥å¯¹è±¡æ˜¯documentï¼Œæˆ‘ä»¬å¯ä»¥learn ä¸€ä¸ªseq2seq2seq çš„model ï¼ŒEncoder åšæ–‡ç« å‹ç¼©ï¼Œå¾—åˆ°ä¸­é—´çš„word sequence ï¼ŒDecoder æ ¹æ®ä¸­é—´è¯åºåˆ—åšæ–‡ç« è¿˜åŸã€‚è¿™æ ·çš„è¯æˆ‘ä»¬ç›´è§‰ä¸Šä¼šè§‰å¾—ï¼Œä¸­é—´çš„word sequence å°±æ˜¯å¯¹æ–‡ç« çš„summary ã€‚ä½†æ˜¯äº‹å®ä¸Šå¦‚æœæˆ‘ä»¬ç›´æ¥è¿™ä¹ˆtrain ä¸‹å»ä¸­é—´çš„ç»“æœæ˜¯ä¸å¯è¯»çš„ã€‚å› ä¸ºï¼ŒEncoder å’ŒDecoder éƒ½æ˜¯æœºå™¨ï¼Œä»–ä»¬ä¼šè‡ªå·±çš„æš—è¯­ï¼Œè¯´ä¸€äº›åªæœ‰ä»–ä»¬æ‰èƒ½æ‡‚çš„word sequence ã€‚æ¯”å¦‚è¯´ï¼Œå°æ¹¾å¤§å­¦ï¼Œä¸­ç»“æœå¯èƒ½ä¸æ˜¯"å°å¤§"ï¼Œè€Œæ˜¯æ˜¯"æ¹¾å­¦"ï¼Œåæ­£åªè¦Deocder èƒ½æ­£ç¡®è§£å›å°æ¹¾å¤§å­¦å°±å¯ä»¥äº†ã€‚

é‚£æ€ä¹ˆè®©Encoder è¾“å‡ºçš„sequence è®©äººèƒ½çœ‹æ‡‚å‘¢ï¼Œæˆ‘ä»¬å°±ç”¨GAN çš„æŠ€æœ¯ã€‚

![image-20201211123024043](images/image-20201211123024043.png)

æˆ‘ä»¬å†é‚£ä¸€ä¸ªDiscriminator æ¥ï¼Œå®ƒæ¥åˆ¤æ–­ä¸€ä¸ªå¥å­æ˜¯ä¸æ˜¯äººå†™çš„ï¼Œè®©Encoder åŠªåŠ›å­¦ä¹ éª—è¿‡Discriminator ã€‚è¿™æ ·å°±èƒ½è®©ä¸­é—´çš„word sequence å˜å¾—äººç±»å¯è¯»ã€‚

ä½ å¯èƒ½åˆè¯´ï¼Œè¿™é‡Œåˆä¸èƒ½å¾®åˆ†å•Šï¼Œä¸­é—´çš„latent representation æ˜¯ä¸€ä¸ªword sequence ï¼Œä¹Ÿæ˜¯Discrete çš„ï¼ŒEncoder Decoder æ•´ä¸ªnetwork åˆèµ·æ¥ä¸èƒ½å¾®åˆ†å•Šã€‚ç¡®å®ä¸èƒ½å¾®åˆ†ï¼Œæ‰€ä»¥å®ä½œçš„æ—¶å€™æ˜¯ç”¨reinforcement learning ç¡¬train Encoder å’ŒDeocder çš„ã€‚

ä¸‹é¢æ˜¯ä¸€äº›å®éªŒç»“æœï¼š

![image-20201211123204980](images/image-20201211123204980.png)

![image-20201211123221056](images/image-20201211123221056.png)



### Tree as Embedding

![image-20201211123735983](images/image-20201211123735983.png)

> https://arxiv.org/abs/1806.07832
>
> https://arxiv.org/abs/1904.03746

å¦å¤–è¿˜æœ‰ä¸€äº›æ¯”è¾ƒæ–°çš„ç ”ç©¶æˆæœï¼Œä¾›å¤§å®¶å‚è€ƒã€‚



## Conclusion

![image-20201211123820607](images/image-20201211123820607.png)

æ€»ç»“ä¸€ä¸‹å°±æ˜¯è®²äº†ï¼š

- é™¤äº†reconstruction error ä»¥å¤–æœ‰æ²¡æœ‰åˆ«çš„åšæ³•
  - Using Discriminator
  - Sequential Data
- æœ‰æ²¡æœ‰æ¯”è¾ƒå¥½çš„è§£é‡Šembedding çš„æ–¹æ³•
  - Feature Disentangle
  - Discrete and Structured 